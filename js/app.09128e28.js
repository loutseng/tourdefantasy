(function(){"use strict";var e={4155:function(e,t,a){var l=a(5130),r=a(3367),s=a(6768);const n={id:"app"},o={id:"footer"},i=(0,s.Lk)("img",{src:"api_logo_cptblWith_strava_horiz_light.png",width:"10%/"},null,-1);function u(e,t,a,l,r,u){const c=(0,s.g2)("NavBar"),d=(0,s.g2)("AutoBot"),p=(0,s.g2)("router-view"),g=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",n,[(0,s.bF)(c),(0,s.bF)(d)]),(0,s.bF)(p),(0,s.Lk)("div",o,[(0,s.bF)(g,{to:"/bypass"},{default:(0,s.k6)((()=>[i])),_:1})])],64)}var c=a(144),d=a(4232),p=a(4373);const g=(0,r.nY)("auth",{state:()=>({user:{},isAuthenticated:!1}),actions:{async login(e){if(e){console.log("requesting jwt "+e);const t=await p.A.get(`https://www.tourdefantasy.com/callback?code=${e}`),{access_token:a}=t.data;localStorage.setItem("token",a)}const t=localStorage.getItem("token");console.log("getting user info "+t);const a=await p.A.get("https://www.tourdefantasy.com/user/me",{headers:{Authorization:`Bearer ${t}`}});this.user=a.data,this.isAuthenticated=!0},async impersonate(e){if(e){const t=await p.A.put(`https://www.tourdefantasy.com/bypass?user_id=${e}`,{}),{access_token:a}=t.data;localStorage.setItem("token",a)}const t=localStorage.getItem("token");console.log("getting user info "+t);const a=await p.A.get("https://www.tourdefantasy.com/user/me",{headers:{Authorization:`Bearer ${t}`}});this.user=a.data,this.isAuthenticated=!0},logout(){this.user={},this.isAuthenticated=!1,localStorage.removeItem("token")}}});a(4114),a(7072),a(4979),a(1678);const v=(0,r.nY)("racer",{state:()=>({allRacers:[],racers:[],draftList:[]}),actions:{async getRacerlist(e){const t=localStorage.getItem("token"),a=await p.A.get(`https://www.tourdefantasy.com/racer/race?race_url=${e}`,{headers:{Authorization:`Bearer ${t}`}}),l=k(),r=new Map;l.players.forEach((e=>{e.active_racers&&e.active_racers.forEach((t=>{r.set(t.url,e.player_strava_id)})),e.bench_racers&&e.bench_racers.forEach((t=>{r.set(t.url,e.player_strava_id)}))})),a.data.forEach((e=>{e.player=r.has(e.url)?r.get(e.url):null})),this.allRacers=a.data},async loadDraftlist(e){const t=localStorage.getItem("token"),a=await p.A.get(`https://www.tourdefantasy.com/racer/draftlist?race_url=${e}`,{headers:{Authorization:`Bearer ${t}`}});this.racers=a.data},async updateDraftlist(e){const t=localStorage.getItem("token");await p.A.put(`https://www.tourdefantasy.com/racer/draftlist?race_url=${e}`,this.racers,{headers:{Authorization:`Bearer ${t}`}})},async getAllDraftlist(e){const t=localStorage.getItem("token"),a=await p.A.get(`https://www.tourdefantasy.com/racer/alldraftlists?league_id=${e}`,{headers:{Authorization:`Bearer ${t}`}}),l=k(),r=l.players,s=a.data;s.forEach((e=>{e.racer_list.forEach((e=>{e.player=null}))})),this.draftList=[],r.forEach((e=>{this.draftList.push(s.find((t=>t.user_strava_id==e.player_strava_id)))}))},insertBefore(e,t){let a=this.racers.find((t=>t.name==e)),l=this.racers.find((e=>e.name==t)),r=this.racers.indexOf(l),s=this.racers.indexOf(a);console.log(a+" "+l+" "+r+" "+s),this.racers.splice(s,1),this.racers.splice(r,0,a)},move(e,t){if(0==e&&"up"==t)return;if(e==this.racers.length-1&&"up"!=t)return;let a=this.racers.splice(e,1);"top"==t?this.racers.splice(0,0,a[0]):this.racers.splice("up"==t?e-1:e+1,0,a[0])}}}),k=(0,r.nY)("league",{state:()=>({league:{},players:[],race:{},leaguePlayer:{},tradeList:[],scoresForStage:[],stagePlayers:[],announcements:[],allLeagues:[]}),actions:{resetData(){this.players=[],this.race={},this.leaguePlayer={},this.tradeList=[],this.scoresForStage=[],this.stagePlayers=[],this.announcements=[],this.allLeagues=[]},async getLeagueList(){const e=localStorage.getItem("token"),t=await p.A.get("https://www.tourdefantasy.com/league",{headers:{Authorization:`Bearer ${e}`}});this.allLeagues=t.data},getPlayerByStravaId(e){return this.players.find((t=>t.player_strava_id==e))},getPlayerPositionByStravaId(e){return this.players.indexOf(this.players.find((t=>t.player_strava_id==e)))},shuffle(){let e=this.players.length;while(0!=e){let t=Math.floor(Math.random()*e);e--,[this.players[e],this.players[t]]=[this.players[t],this.players[e]]}},async submitDraft(){const e=localStorage.getItem("token");await p.A.put("https://www.tourdefantasy.com/league/draftresult",this.players.slice().reverse(),{headers:{Authorization:`Bearer ${e}`}})},async join(e,t){if(e){const a=localStorage.getItem("token"),l=await p.A.put(`https://www.tourdefantasy.com/league/join?code=${e}&nickname=${t}`,{},{headers:{Authorization:`Bearer ${a}`}});this.league=l.data,this.resetData()}},async getRace(){const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/race/url?url=${this.league.active_race_url}`,{headers:{Authorization:`Bearer ${e}`}});this.race=t.data},getStageNameByURL(e){let t=this.race.days.find((e=>{e.url}));return t?t.name:"--"},async getRaceScoreByStage(e){const t=localStorage.getItem("token"),a=await p.A.get(`https://www.tourdefantasy.com/racerScore/search?stage=${e}`,{headers:{Authorization:`Bearer ${t}`}});this.scoresForStage=a.data;let l=Map.groupBy(this.scoresForStage,(({racer:e})=>e));const r=v();let s=this.players.slice();s.forEach((t=>{t.stage_scores&&t.stage_scores.find((t=>t.stage_url==e))?t.stageRacers=t.stage_scores.find((t=>t.stage_url==e)).racers.slice():t.stageRacers=t.active_racers.slice(),t.stageRacers.forEach((e=>{e.scores=null,l.has(e.url)&&(e.scores=l.get(e.url),l.delete(e.url))}))}));const n={player_nickname:"N/A",stageRacers:[]};l.forEach(((e,t)=>{let a=structuredClone(r.allRacers.find((e=>e.url==t)));a.scores=e,n.stageRacers.push(a)})),s.push(n);let o=[0,0,20,30,50];s.forEach((e=>{e.stageScore=0,e.jerseys=[],e.stageRacers.forEach((t=>{t.scores&&t.scores.forEach((t=>{e.stageScore+=t.point,0==t.point&&e.jerseys.push(t.category)}))})),e.stageScore+=o[e.jerseys.length]})),this.stagePlayers=s},async submitStageScore(e){let t=0,a=null;console.log("Calculating score for players: "+this.players),this.players.forEach((l=>{let r={stage_url:e,total_score:l.stageScore,racers:l.stageRacers};l.stageScore>t&&(t=l.stageScore,a=l.player_nickname),l.stage_scores||(l.stage_scores=[]);let s=l.stage_scores.findIndex((t=>t.stage_url==e));-1!=s?l.stage_scores.splice(s,1,r):l.stage_scores.push(r),l.current_score=l.stage_scores.reduce(((e,{total_score:t})=>e+t),0);const n=localStorage.getItem("token");p.A.put("https://www.tourdefantasy.com/league/leagueplayers",l,{headers:{Authorization:`Bearer ${n}`}}),l.stageScore=0,l.stageRacers=[]})),console.log(this.race.days);let l="New scores are in! <strong>"+a+"</strong> scored "+t;const r=localStorage.getItem("token");await p.A.post("https://www.tourdefantasy.com/league/announcement",{message:l,expiration:Date.now()+108e5,league_id:this.league.id},{headers:{Authorization:`Bearer ${r}`}})},async loadLeague(e){const t=localStorage.getItem("token"),a=await p.A.get(`https://www.tourdefantasy.com/league/id/${e}`,{headers:{Authorization:`Bearer ${t}`}});this.league=a.data,this.resetData()},async getLeaguePlayers(e){const t=localStorage.getItem("token"),a=await p.A.get(`https://www.tourdefantasy.com/league/${e}/players`,{headers:{Authorization:`Bearer ${t}`}}),l=g();this.leaguePlayer=a.data.find((e=>e.player_strava_id==l.user.strava_id));let r=[a.data.length];a.data.forEach((e=>{r[this.league.players.indexOf(e.player_strava_id)]=e,e.stage_scores&&e.stage_scores.sort(((e,t)=>parseInt(t.stage_url.substring(t.stage_url.lastIndexOf("-")+1))-parseInt(e.stage_url.substring(e.stage_url.lastIndexOf("-")+1))))})),this.players=r,console.log("Players retrieved: "+this.players)},moveRoaster(e,t){let a=this.leaguePlayer.active_racers.concat(this.leaguePlayer.bench_racers),l=a.find((t=>t.name==e));this.leaguePlayer.active_racers?this.leaguePlayer.active_racers=this.leaguePlayer.active_racers.filter((t=>(console.log(t.name==e),t.name!==e))):this.leaguePlayer.active_racers=[],this.leaguePlayer.bench_racers?this.leaguePlayer.bench_racers=this.leaguePlayer.bench_racers.filter((t=>t.name!==e)):this.leaguePlayer.bench_racers=[],"active"==t?this.leaguePlayer.active_racers.push(l):this.leaguePlayer.bench_racers.push(l)},async submitRoaster(){const e=localStorage.getItem("token"),t=await p.A.put("https://www.tourdefantasy.com/league/leagueplayers",this.leaguePlayer,{headers:{Authorization:`Bearer ${e}`}});console.log("submit roaster: "+t),await p.A.post("https://www.tourdefantasy.com/league/announcement",{message:"<strong>"+this.leaguePlayer.player_nickname+"</strong> updated roster!",expiration:Date.now()+108e5,league_id:this.league.id},{headers:{Authorization:`Bearer ${e}`}}),200==t.status&&alert("Roster change successful.")},async submitTrade(e,t){e.player=this.leaguePlayer.player_strava_id.toString();const a=localStorage.getItem("token"),l=await p.A.post(`https://www.tourdefantasy.com/league/trade?league_id=${this.league.id}`,{fromRacer:e,toRacer:t},{headers:{Authorization:`Bearer ${a}`}});this.tradeList=l.data,await p.A.post("https://www.tourdefantasy.com/league/announcement",{message:"<strong>"+this.leaguePlayer.player_nickname+"</strong> submitted a trade request!",expiration:Date.now()+108e5,league_id:this.league.id},{headers:{Authorization:`Bearer ${a}`}})},async getTradeRequests(){const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/league/traderequests?league_id=${this.league.id}`,{headers:{Authorization:`Bearer ${e}`}});let a=t.data.slice();a.sort(((e,t)=>{let a=e.toRacer.ranking-t.toRacer.ranking;if(0==a){let a=this.players.indexOf(this.players.find((e=>e.player_strava_id==t.player_strava_id))),l=this.players.indexOf(this.players.find((t=>t.player_strava_id==e.player_strava_id)));return l-a}return a}));const l=[],r=[];a.forEach((e=>{-1==l.findIndex((t=>t.url==e.toRacer.url))&&-1==r.indexOf(e.player_strava_id)&&(l.push(e.toRacer),r.push(e.player_strava_id),e.selected=!0)})),this.tradeList=a},async getMultiTradeRequests(){const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/league/traderequests?league_id=${this.league.id}`,{headers:{Authorization:`Bearer ${e}`}});let a=t.data.slice();const l=this.league.players.slice(),r=Map.groupBy(a,(({player_strava_id:e})=>e)),s=[];while(r.size>0)l.forEach((e=>{let t=r.get(e);if(t){while(t.length){let e=t.shift();if(!s.includes(e.toRacer.url)&&!s.includes(e.fromRacer.url)){s.push(e.fromRacer.url),s.push(e.toRacer.url),e.selected=!0;break}}0==t.length&&r.delete(e)}}));this.tradeList=a},async cancelTradeRequest(e){const t=localStorage.getItem("token");await p.A.delete(`https://www.tourdefantasy.com/league/canceltrade?id=${e}`,{headers:{Authorization:`Bearer ${t}`}}),await this.getTradeRequests()},async completeTradeRequests(){let e=[],t=this.tradeList.filter((e=>e.selected));t.forEach((t=>{let a=this.players.find((e=>e.player_strava_id==t.player_strava_id)),l=-1==a.active_racers.findIndex((e=>e.url==t.fromRacer.url))?a.bench_racers:a.active_racers;l.splice(l.findIndex((e=>e.url==t.fromRacer.url)),1,t.toRacer),e.push(a)})),e.sort(((e,t)=>{this.league.players.indexOf(t.player_strava_id),this.league.players.indexOf(e.player_strava_id)})),e.forEach((e=>{this.players.splice(this.players.indexOf(e),1),this.players.push(e)}));const a=localStorage.getItem("token");await p.A.put("https://www.tourdefantasy.com/league/completetrade",{accepted:t,players:this.players},{headers:{Authorization:`Bearer ${a}`}});let l=t.length>0?"Trade results: <br>":"No trade completed.";t.forEach((e=>{l=l.concat("<strong>"+this.getPlayerByStravaId(e.player_strava_id).player_nickname+"</strong> acquired <strong>"+e.toRacer.name+"</strong><br>")})),await p.A.post("https://www.tourdefantasy.com/league/announcement",{message:l,expiration:Date.now()+108e5,league_id:this.league.id},{headers:{Authorization:`Bearer ${a}`}})},async getAnnouncements(){const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/league/newannouncements?league_id=${this.league.id}&expiration=${Date.now()}`,{headers:{Authorization:`Bearer ${e}`}});this.announcements=t.data},async getAllAnnouncements(){const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/league/announcements?league_id=${this.league.id}`,{headers:{Authorization:`Bearer ${e}`}});this.announcements=t.data},parseChunk(e){const t=e.split(/\r\n\r\n|\r\r|\n\n/g);if(0===t.length)return;const a=[];for(const l of t){let e="";const t=l.split(/\n|\r|\r\n/g);let r="";for(const a of t){const t=/([^:]+)(?:: ?(.*))?/.exec(a);if(t){const a=t[1],l=t[2]||"";switch(a){case"event":e=l;break;case"data":r+=l,r+="\n";break;case"id":l.includes("\0")||(this.lastEventId=l);break}}}""!==r&&("\n"===r[r.length-1]&&(r=r.slice(0,-1)),a.push({eventType:e,data:r}))}return a}}}),h={class:"navbar navbar-expand-lg bg-dark border-bottom border-body","data-bs-theme":"dark"},m={class:"container-fluid"},y=(0,s.Lk)("a",{class:"navbar-brand",href:"#"},"TourDeFantasy",-1),L=(0,s.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,s.Lk)("span",{class:"navbar-toggler-icon"})],-1),f={class:"collapse navbar-collapse",id:"navbarSupportedContent"},_={class:"navbar-nav me-auto mb-2 mb-lg-0"},b={class:"nav-item"},w={class:"nav-item"},C={key:0,class:"nav-item dropdown"},E={class:"dropdown-menu"},R={key:1,class:"nav-item"},A={key:2,class:"nav-item"},x={key:3,class:"nav-item"},X={key:4,class:"nav-item"},S={class:"nav-item"},I={key:5,class:"nav-item dropdown"},T=(0,s.Lk)("a",{class:"nav-link dropdown-toggle",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Profile ",-1),F={class:"dropdown-menu"},K={key:6,class:"nav-item dropdown"},P=(0,s.Lk)("a",{class:"nav-link dropdown-toggle",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Admin ",-1),$={class:"dropdown-menu"},B={class:"nav-item"},D={key:7,class:"nav-item"};var M={__name:"NavBar",setup(e){const t=g(),a=k(),l=(0,c.KR)([]),r=async()=>{const e=localStorage.getItem("token"),a=await p.A.get("https://www.tourdefantasy.com/league/leagueplayers",{headers:{Authorization:`Bearer ${e}`}});l.value=a.data.slice().filter((e=>e.player_strava_id==t.user.strava_id))};return(0,s.sV)((()=>{})),(e,n)=>{const o=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("nav",h,[(0,s.Lk)("div",m,[y,L,(0,s.Lk)("div",f,[(0,s.Lk)("ul",_,[(0,s.Lk)("li",b,[(0,s.bF)(o,{class:"nav-link",to:"/leaguehome"},{default:(0,s.k6)((()=>[(0,s.eW)("Home")])),_:1})]),(0,s.Lk)("li",w,[(0,s.bF)(o,{class:"nav-link",to:"/leaguepreview"},{default:(0,s.k6)((()=>[(0,s.eW)("League Preview")])),_:1})]),(0,c.R1)(t).isAuthenticated?((0,s.uX)(),(0,s.CE)("li",C,[(0,s.Lk)("a",{class:"nav-link dropdown-toggle",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",onClick:r}," Leagues "),(0,s.Lk)("ul",E,[(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/createleague"},{default:(0,s.k6)((()=>[(0,s.eW)("Create League")])),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/joinleague"},{default:(0,s.k6)((()=>[(0,s.eW)("Join League")])),_:1})]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e},[(0,s.bF)(o,{class:"dropdown-item",to:{path:"/joinleague",query:{leagueId:e.league_id,nickname:e.player_nickname}}},{default:(0,s.k6)((()=>[(0,s.eW)(" → "+(0,d.v_)(e.player_nickname),1)])),_:2},1032,["to"])])))),128)),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/livedraft"},{default:(0,s.k6)((()=>[(0,s.eW)("Draft Party")])),_:1})])])])):(0,s.Q3)("",!0),(0,c.R1)(t).isAuthenticated&&(0,c.R1)(a).leaguePlayer.active_racers?((0,s.uX)(),(0,s.CE)("li",R,[(0,s.bF)(o,{class:"nav-link",to:"/roster"},{default:(0,s.k6)((()=>[(0,s.eW)("Roster")])),_:1})])):(0,s.Q3)("",!0),(0,c.R1)(t).isAuthenticated?((0,s.uX)(),(0,s.CE)("li",A,[(0,s.bF)(o,{class:"nav-link",to:"/draftlist"},{default:(0,s.k6)((()=>[(0,s.eW)("Draft")])),_:1})])):(0,s.Q3)("",!0),(0,c.R1)(t).isAuthenticated?((0,s.uX)(),(0,s.CE)("li",x,[(0,s.bF)(o,{class:"nav-link",to:"/fullscores"},{default:(0,s.k6)((()=>[(0,s.eW)("Full Scores")])),_:1})])):(0,s.Q3)("",!0),(0,c.R1)(t).isAuthenticated&&[13,14,15,16,17,18,19,20,21].includes((new Date).getHours())?((0,s.uX)(),(0,s.CE)("li",X,[(0,s.bF)(o,{class:"nav-link",to:"/trade"},{default:(0,s.k6)((()=>[(0,s.eW)("Trade")])),_:1})])):(0,s.Q3)("",!0),(0,s.Lk)("li",S,[(0,s.bF)(o,{class:"nav-link",to:"/trade"},{default:(0,s.k6)((()=>[(0,s.eW)("Trade")])),_:1})]),(0,c.R1)(t).isAuthenticated&&"impersonate"!=(0,c.R1)(t).user.username?((0,s.uX)(),(0,s.CE)("li",I,[T,(0,s.Lk)("ul",F,[(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/profile"},{default:(0,s.k6)((()=>[(0,s.eW)("Info")])),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/stats"},{default:(0,s.k6)((()=>[(0,s.eW)("Stats")])),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/activities"},{default:(0,s.k6)((()=>[(0,s.eW)("Activities")])),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/routes"},{default:(0,s.k6)((()=>[(0,s.eW)("Routes")])),_:1})])])])):(0,s.Q3)("",!0),(0,c.R1)(t).isAuthenticated&&(0,c.R1)(t).user.roles.includes("admin")?((0,s.uX)(),(0,s.CE)("li",K,[P,(0,s.Lk)("ul",$,[(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/racecenter"},{default:(0,s.k6)((()=>[(0,s.eW)("Race Center")])),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/rundraft"},{default:(0,s.k6)((()=>[(0,s.eW)("Run Draft")])),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/runtrade"},{default:(0,s.k6)((()=>[(0,s.eW)("Run Trade")])),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/runscore"},{default:(0,s.k6)((()=>[(0,s.eW)("Run Score")])),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/autocenter"},{default:(0,s.k6)((()=>[(0,s.eW)("Automation Center")])),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/createleague"},{default:(0,s.k6)((()=>[(0,s.eW)("Create League")])),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(o,{class:"dropdown-item",to:"/runlivedraft"},{default:(0,s.k6)((()=>[(0,s.eW)("Run Draft Party")])),_:1})])])])):(0,s.Q3)("",!0),(0,s.Lk)("li",B,[(0,s.bF)(o,{class:"nav-link",to:"/about"},{default:(0,s.k6)((()=>[(0,s.eW)("Rules")])),_:1})]),(0,c.R1)(t).isAuthenticated?((0,s.uX)(),(0,s.CE)("li",D,[(0,s.bF)(o,{class:"nav-link",to:"/logout"},{default:(0,s.k6)((()=>[(0,s.eW)("Logout")])),_:1})])):(0,s.Q3)("",!0)])])])])}}};const q=M;var j=q,W=a(1387);const N=(0,r.nY)("auto",{state:()=>({tasks:[],currentTask:null,isAutoMode:!1}),actions:{flip(){this.isAutoMode=!this.isAutoMode},startTask(){if(this.currentTask)return null;let e=this.tasks.find((e=>!e.completed&&new Date>e.time));return e&&(this.currentTask=e,e.inProgress=!0),console.log("return "+e),e},completeTask(){this.currentTask.completed=!0,this.currentTask=null}}}),z={key:0,style:{color:"red"}},V=(0,s.Lk)("b",null,"Auto",-1),O=[V];var H={__name:"AutoBot",setup(e){const t=N(),a=(0,W.rd)(),l=(0,c.KR)(0),r=()=>{if(t.isAutoMode){let e=t.startTask();console.log("found task: "+e),e&&a.push(e.path)}};return(0,s.sV)((async()=>{let e=setInterval(r,3e5);console.log(`autobot ${e} is loaded.`),l.value=e})),(e,a)=>(0,c.R1)(t).isAutoMode?((0,s.uX)(),(0,s.CE)("h1",z,O)):(0,s.Q3)("",!0)}};const Q=H;var U=Q,J={name:"App",components:{NavBar:j,AutoBot:U}},Y=a(1241);const G=(0,Y.A)(J,[["render",u]]);var Z=G;const ee=e=>((0,s.Qi)("data-v-23c4ca94"),e=e(),(0,s.jt)(),e),te={id:"intro",class:"bg-image shadow-2-strong"},ae={class:"container d-flex align-items-center justify-content-center text-center h-100"},le={class:"card text-bg-dark w-50 w-md-50"},re=ee((()=>(0,s.Lk)("h2",{class:"card-header"},"Sign In",-1))),se={class:"card-body"},ne=ee((()=>(0,s.Lk)("img",{src:"btn_strava_connectwith_orange.png",class:"img-fluid"},null,-1))),oe=[ne];function ie(e,t,a,l,r,n){return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("div",te,[(0,s.Lk)("div",ae,[(0,s.Lk)("div",le,[re,(0,s.Lk)("div",se,[(0,s.Lk)("button",{class:"btn",onClick:t[0]||(t[0]=(...e)=>n.login&&n.login(...e))},oe)])])])])])}var ue={async created(){const e=localStorage.getItem("token");if(e){console.log("getting user info "+e);try{const e=g(),t=k();await e.login(),e.user.current_league_id?(await t.loadLeague(e.user.current_league_id),this.$router.push({name:"LeagueHome"})):this.$router.push({name:"JoinLeague"})}catch(t){console.error("Error during auto login:",t),localStorage.removeItem("token")}}},methods:{login(){window.location.href="https://www.tourdefantasy.com/login"}}};const ce=(0,Y.A)(ue,[["render",ie],["__scopeId","data-v-23c4ca94"]]);var de=ce;const pe=(0,s.Lk)("p",null,"Logging in...",-1),ge=[pe];function ve(e,t,a,l,r,n){return(0,s.uX)(),(0,s.CE)("div",null,ge)}a(4603),a(7566),a(8721);var ke={async created(){const e=new URLSearchParams(window.location.search),t=e.get("code");if(t)try{const e=g(),a=k();await e.login(t),e.user.current_league_id?(await a.loadLeague(e.user.current_league_id),this.$router.push({name:"LeagueHome"})):this.$router.push({name:"JoinLeague"})}catch(a){console.error("Error during callback:",a)}}};const he=(0,Y.A)(ke,[["render",ve]]);var me=he;const ye=(0,s.Lk)("h1",null,"My Activities",-1);function Le(e,t,a,l,r,n){return(0,s.uX)(),(0,s.CE)("div",null,[ye,(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.activities,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id},(0,d.v_)(e.name),1)))),128))])])}var fe={data(){return{activities:[]}},async created(){const e=localStorage.getItem("token");if(e)try{const t=await p.A.get("https://www.tourdefantasy.com/activities",{headers:{Authorization:`Bearer ${e}`}});this.activities=t.data}catch(t){console.error("Error fetching activities:",t),this.$router.push({name:"Login"})}else this.$router.push({name:"Login"})}};const _e=(0,Y.A)(fe,[["render",Le]]);var be=_e;const we=(0,s.Lk)("h1",null,"My Routes",-1),Ce=(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Name"),(0,s.Lk)("th",null,"Distance"),(0,s.Lk)("th",null,"Elevation")],-1);function Ee(e,t,a,l,r,n){return(0,s.uX)(),(0,s.CE)("div",null,[we,(0,s.Lk)("table",null,[Ce,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.routes,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,d.v_)(e.name),1),(0,s.Lk)("td",null,(0,d.v_)(e.distance),1),(0,s.Lk)("td",null,(0,d.v_)(e.elevation_gain),1)])))),128))])])}var Re={data(){return{routes:[]}},async created(){const e=localStorage.getItem("token");if(e)try{const t=await p.A.get("https://www.tourdefantasy.com/routes",{headers:{Authorization:`Bearer ${e}`}});this.routes=t.data}catch(t){console.error("Error fetching routes:",t),this.$router.push({name:"Login"})}else this.$router.push({name:"Login"})}};const Ae=(0,Y.A)(Re,[["render",Ee]]);var xe=Ae;const Xe=(0,s.Lk)("h1",null,"My Stats",-1),Se=(0,s.Lk)("td",null,"Longest distance",-1),Ie=(0,s.Lk)("td",null,"Most elevation",-1);function Te(e,t,a,l,r,n){const o=(0,s.g2)("RideTotal");return(0,s.uX)(),(0,s.CE)("div",null,[Xe,(0,s.bF)(o,{title:"All Time",rideTotals:r.allTimeTotals},null,8,["rideTotals"]),(0,s.bF)(o,{title:"Last 4 Weeks",rideTotals:r.recentTotals},null,8,["rideTotals"]),(0,s.bF)(o,{title:"This year",rideTotals:r.yearTotals},null,8,["rideTotals"]),(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[Se,(0,s.Lk)("td",null,(0,d.v_)(r.stats.biggest_ride_distance),1)]),(0,s.Lk)("tr",null,[Ie,(0,s.Lk)("td",null,(0,d.v_)(r.stats.biggest_climb_elevation_gain),1)])])])}const Fe=(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Activities"),(0,s.Lk)("th",null,"Distance"),(0,s.Lk)("th",null,"Elev Gain"),(0,s.Lk)("th",null,"Time")],-1);function Ke(e,t,a,l,r,n){return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("h3",null,(0,d.v_)(a.title),1),(0,s.Lk)("table",null,[Fe,(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,(0,d.v_)(a.rideTotals.count),1),(0,s.Lk)("td",null,(0,d.v_)(a.rideTotals.distance),1),(0,s.Lk)("td",null,(0,d.v_)(a.rideTotals.elevation_gain),1),(0,s.Lk)("td",null,(0,d.v_)(a.rideTotals.moving_time),1)])])])}var Pe={props:{title:String,rideTotals:Object}};const $e=(0,Y.A)(Pe,[["render",Ke]]);var Be=$e,De={data(){return{stats:{},allTimeTotals:{},recentTotals:{},yearTotals:{}}},components:{RideTotal:Be},async created(){const e=localStorage.getItem("token");if(e)try{const t=await p.A.get("https://www.tourdefantasy.com/stats",{headers:{Authorization:`Bearer ${e}`}});this.stats=t.data,this.allTimeTotals=t.data.all_ride_totals,this.recentTotals=t.data.recent_ride_totals,this.yearTotals=t.data.ytd_ride_totals}catch(t){console.error("Error fetching stats:",t),this.$router.push({name:"Login"})}else this.$router.push({name:"Login"})}};const Me=(0,Y.A)(De,[["render",Te]]);var qe=Me;const je=(0,s.Lk)("p",null,"Logging out...",-1),We=[je];function Ne(e,t,a,l,r,n){return(0,s.uX)(),(0,s.CE)("div",null,We)}var ze={async created(){const e=g();e.logout(),this.$router.push({name:"Login"})}};const Ve=(0,Y.A)(ze,[["render",Ne]]);var Oe=Ve;const He=(0,s.Lk)("h1",null,"My Profile",-1),Qe=(0,s.Lk)("td",null,"User Name",-1),Ue=(0,s.Lk)("td",null,"First Name",-1),Je=(0,s.Lk)("td",null,"Last Name",-1),Ye=(0,s.Lk)("td",null,"Location",-1),Ge=(0,s.Lk)("td",null,"Roles",-1),Ze=(0,s.Lk)("td",null,"Roles",-1),et=["id","value"],tt=["for"],at=(0,s.Lk)("td",null,"Profile Pic",-1),lt=["src"];var rt={__name:"ProfileView",setup(e){const t=g(),a=(0,c.KR)(t.user),r=["user","super","admin"];return(0,s.sV)((()=>{})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[He,(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[Qe,(0,s.Lk)("td",null,(0,d.v_)(a.value.username),1)]),(0,s.Lk)("tr",null,[Ue,(0,s.Lk)("td",null,(0,d.v_)(a.value.firstname),1)]),(0,s.Lk)("tr",null,[Je,(0,s.Lk)("td",null,(0,d.v_)(a.value.lastname),1)]),(0,s.Lk)("tr",null,[Ye,(0,s.Lk)("td",null,(0,d.v_)(a.value.city)+", "+(0,d.v_)(a.value.state),1)]),(0,s.Lk)("tr",null,[Ge,(0,s.Lk)("td",null,(0,d.v_)(a.value.roles),1)]),(0,s.Lk)("tr",null,[Ze,(0,s.Lk)("td",null,[(0,s.Lk)("ul",null,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(r,(e=>(0,s.Lk)("li",{key:e.id},[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",id:e,value:e,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value.roles=e),disabled:"disabled"},null,8,et),[[l.lH,a.value.roles]]),(0,s.Lk)("label",{for:e.id},(0,d.v_)(e),9,tt)]))),64))])])]),(0,s.Lk)("tr",null,[at,(0,s.Lk)("td",null,[(0,s.Lk)("img",{src:a.value.profile_pic},null,8,lt)])])])]))}};const st=rt;var nt=st;const ot=(0,s.Lk)("h1",{class:"mt-4"},"Join League",-1),it={class:"container px-4 text-center"},ut={class:"row gx-5 mb-3"},ct={class:"col"},dt=(0,s.Lk)("label",{for:"inputPassword",class:"form-label"},"League Password",-1),pt={class:"row gx-5 mb-3"},gt={class:"col"},vt=(0,s.Lk)("label",{for:"exampleInputPassword1",class:"form-label"},"Nickname",-1),kt={class:"row gx-5"},ht={class:"col"};var mt={__name:"JoinLeagueView",setup(e){const t=g(),a=(0,W.rd)(),r=k(),n=(0,c.KR)(t.user),o=(0,c.KR)(""),i=(0,c.KR)(""),u=async()=>{await r.join(o.value,i.value,n.value.strava_id),a.push({name:"LeagueHome"})};return(0,s.sV)((async()=>{const e=new URLSearchParams(window.location.search).get("leagueId");if(e){const t=new URLSearchParams(window.location.search).get("nickname"),l=localStorage.getItem("token"),s=await p.A.get(`https://www.tourdefantasy.com/league/id/${e}`,{headers:{Authorization:`Bearer ${l}`}});await r.join(s.data.password,t,n.value.strava_id),a.push({name:"LeagueHome"})}})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[ot,(0,s.Lk)("form",null,[(0,s.Lk)("div",it,[(0,s.Lk)("div",ut,[(0,s.Lk)("div",ct,[dt,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),class:"form-control",id:"inputPassword","aria-describedby":"emailHelp"},null,512),[[l.Jo,o.value]])])]),(0,s.Lk)("div",pt,[(0,s.Lk)("div",gt,[vt,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),class:"form-control",id:"exampleInputPassword1"},null,512),[[l.Jo,i.value]])])]),(0,s.Lk)("div",kt,[(0,s.Lk)("div",ht,[(0,s.Lk)("button",{onClick:(0,l.D$)(u,["prevent"]),class:"btn btn-success"},"Join")])])])])]))}};const yt=mt;var Lt=yt;const ft=e=>((0,s.Qi)("data-v-0296de82"),e=e(),(0,s.jt)(),e),_t={class:"mt-4"},bt=ft((()=>(0,s.Lk)("button",{type:"button",class:"btn btn-success","data-bs-toggle":"modal","data-bs-target":"#exampleModal"}," League Info ",-1))),wt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ct={class:"modal-dialog"},Et={class:"modal-content"},Rt=ft((()=>(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"League Info"),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),At={class:"modal-body"},xt=ft((()=>(0,s.Lk)("td",null,"Id",-1))),Xt=ft((()=>(0,s.Lk)("td",null,"Name",-1))),St=ft((()=>(0,s.Lk)("td",null,"Password",-1))),It=ft((()=>(0,s.Lk)("td",null,"Active Race",-1))),Tt=["href"],Ft=ft((()=>(0,s.Lk)("h3",{class:"mt-4 text-success",style:{"text-decoration":"underline"}},"Newsfeed",-1))),Kt={key:0},Pt={class:"container w-75 h-50"},$t={class:"announcements-container"},Bt=["innerHTML"],Dt={class:"table mt-4"},Mt=ft((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{scope:"col"},"#"),(0,s.Lk)("th",{scope:"col"},"Username"),(0,s.Lk)("th",{scope:"col"},"Points")])],-1))),qt={key:0},jt={key:1};var Wt={__name:"LeagueHome",setup(e){const t=k(),a=(0,c.KR)(t.league),l=(0,s.EW)((()=>{let e=t.players.slice();return e.sort(((e,t)=>t.current_score-e.current_score)),e})),r=(0,s.EW)((()=>t.announcements.slice().reverse())),n=t.getLeaguePlayers;return(0,s.sV)((()=>{n(a.value.id),t.getRace(),t.getAnnouncements()})),(e,n)=>{const o=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("h1",_t,(0,d.v_)(a.value.name),1),bt,(0,s.Lk)("div",wt,[(0,s.Lk)("div",Ct,[(0,s.Lk)("div",Et,[Rt,(0,s.Lk)("div",At,[(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[xt,(0,s.Lk)("td",null,(0,d.v_)(a.value.id),1)]),(0,s.Lk)("tr",null,[Xt,(0,s.Lk)("td",null,(0,d.v_)(a.value.name),1)]),(0,s.Lk)("tr",null,[St,(0,s.Lk)("td",null,(0,d.v_)(a.value.password),1)]),(0,s.Lk)("tr",null,[It,(0,s.Lk)("td",null,[(0,s.Lk)("a",{href:a.value.active_race_url,target:"prosite"},(0,d.v_)(a.value.activeRace),9,Tt)])])])])])])]),(0,s.bF)(o,{class:"nav-link text-decoration-none",to:"/newsfeed"},{default:(0,s.k6)((()=>[Ft])),_:1}),0!=r.value.length?((0,s.uX)(),(0,s.CE)("div",Kt,[(0,s.Lk)("div",Pt,[(0,s.Lk)("div",$t,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:"alert alert-success alert-dismissible fade show",role:"alert"},[(0,s.Lk)("span",{innerHTML:e.message},null,8,Bt)])))),128))])])])):(0,s.Q3)("",!0),(0,s.Lk)("table",Dt,[Mt,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,((e,a)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.player_strava_id},[(0,s.Lk)("td",null,(0,d.v_)(a+1),1),e.player_strava_id!=(0,c.R1)(t).leaguePlayer.player_strava_id?((0,s.uX)(),(0,s.CE)("td",qt,[(0,s.bF)(o,{to:{path:"/rosterview",query:{userId:e.player_strava_id}}},{default:(0,s.k6)((()=>[(0,s.eW)((0,d.v_)(e.player_nickname),1)])),_:2},1032,["to"])])):((0,s.uX)(),(0,s.CE)("td",jt,[(0,s.bF)(o,{to:{path:"/roster"}},{default:(0,s.k6)((()=>[(0,s.eW)((0,d.v_)(e.player_nickname),1)])),_:2},1024)])),(0,s.Lk)("td",null,[(0,s.bF)(o,{to:{path:"/detailscore",query:{userId:e.player_strava_id}}},{default:(0,s.k6)((()=>[(0,s.eW)((0,d.v_)(e.current_score),1)])),_:2},1032,["to"])])])))),128))])])])}}};const Nt=(0,Y.A)(Wt,[["__scopeId","data-v-0296de82"]]);var zt=Nt;const Vt=e=>((0,s.Qi)("data-v-ed29272a"),e=e(),(0,s.jt)(),e),Ot={key:0},Ht={class:"table mt-4"},Qt=Vt((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{scope:"col"},"#"),(0,s.Lk)("th",{scope:"col"},"Username"),(0,s.Lk)("th",{scope:"col"},"Points")])],-1))),Ut=["data-bs-target"],Jt=["id"],Yt={class:"modal-dialog"},Gt={class:"modal-content"},Zt={class:"modal-header"},ea={class:"modal-title fs-5",id:"exampleModalLabel"},ta={class:"modal-body"},aa={class:"d-flex justify-content-center mt-3"},la={class:"list-group"},ra={class:"d-flex align-items-center"},sa=Vt((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),na={class:"content-wrapper"},oa=["href"],ia={key:0},ua={key:1},ca={class:"list-group"},da={class:"d-flex align-items-center"},pa=Vt((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),ga={class:"content-wrapper"},va=["href"],ka={key:0},ha={key:1},ma=Vt((()=>(0,s.Lk)("div",{class:"btn-group ms-2",role:"group","aria-label":"Basic example"},null,-1))),ya=["data-bs-target"],La=["id"],fa={class:"modal-dialog"},_a={class:"modal-content"},ba={class:"modal-header"},wa={class:"modal-title fs-5",id:"exampleModalLabel2"},Ca=Vt((()=>(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))),Ea={class:"modal-body"},Ra=["href"],Aa={class:"table"},xa=Vt((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{scope:"col"},"Racer"),(0,s.Lk)("th",{scope:"col"},"Points Earned"),(0,s.Lk)("th",{scope:"col"},"How Earned")])],-1))),Xa={key:0},Sa={key:0},Ia=Vt((()=>(0,s.Lk)("img",{src:"/white.png",alt:"White Jersey",style:{width:"20px",height:"20px"}},null,-1))),Ta=[Ia],Fa={key:1},Ka=Vt((()=>(0,s.Lk)("img",{src:"/yellow.png",alt:"Yellow Jersey",style:{width:"20px",height:"20px"}},null,-1))),Pa=[Ka],$a={key:2},Ba=Vt((()=>(0,s.Lk)("img",{src:"/green.png",alt:"Green Jersey",style:{width:"20px",height:"20px"}},null,-1))),Da=[Ba],Ma={key:3},qa=Vt((()=>(0,s.Lk)("img",{src:"/polkadot.png",alt:"Polka-dot Jersey",style:{width:"20px",height:"20px"}},null,-1))),ja=[qa],Wa={key:0},Na={key:0},za={key:1},Va={key:0},Oa={key:0},Ha={class:"border-bottom border-2"},Qa=Vt((()=>(0,s.Lk)("th",{scope:"row"},"Total",-1))),Ua=Vt((()=>(0,s.Lk)("td",null,null,-1)));var Ja={__name:"LeaguePreviewPopup",props:{leagueId:{type:String,required:!0}},setup(e){const t=(0,c.KR)([]),a=(0,c.KR)({}),l=(0,s.EW)((()=>{let e=t.value.slice();return e.sort(((e,t)=>t.current_score-e.current_score)),e})),r=async()=>{const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/league/id/${k.leagueId}`,{headers:{Authorization:`Bearer ${e}`}});a.value=t.data},n=async()=>{const e=localStorage.getItem("token"),a=await p.A.get(`https://www.tourdefantasy.com/league/${k.leagueId}/players`,{headers:{Authorization:`Bearer ${e}`}});t.value=a.data},o=(0,c.KR)([]),i=(0,c.KR)(new Map),u=async()=>{const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/racerScore/search?race=${a.value.active_race_url}`,{headers:{Authorization:`Bearer ${e}`}});o.value=t.data;let l=Map.groupBy(o.value,(({stage:e})=>e));l.forEach(((e,t,a)=>{a.set(t,Map.groupBy(e,(({racer:e})=>e)))})),i.value=l},g=(0,c.KR)(null),v=async()=>{const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/race/url?url=${a.value.active_race_url}`,{headers:{Authorization:`Bearer ${e}`}});console.log(t.data),g.value=Map.groupBy(t.data.days,(({url:e})=>e))};(0,s.sV)((async()=>{console.log("Mounted"),await r(),await n(),await u(),await v()}));const k=e;return(e,t)=>g.value?((0,s.uX)(),(0,s.CE)("div",Ot,[(0,s.Lk)("table",Ht,[Qt,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,((a,l)=>((0,s.uX)(),(0,s.CE)("tr",{key:l},[(0,s.Lk)("td",null,(0,d.v_)(l+1),1),(0,s.Lk)("td",null,[(0,s.Lk)("button",{type:"button",class:"btn btn-link p-0 m-0","data-bs-toggle":"modal","data-bs-target":"#"+a.player_strava_id},(0,d.v_)(a.player_nickname),9,Ut)]),(0,s.Lk)("div",{class:"modal fade",id:a.player_strava_id,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[(0,s.Lk)("div",Yt,[(0,s.Lk)("div",Gt,[(0,s.Lk)("div",Zt,[(0,s.Lk)("h1",ea,(0,d.v_)(a.player_nickname)+"'s Roster",1),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal",onClick:t[0]||(t[0]=(...t)=>e.closeModal&&e.closeModal(...t)),"aria-label":"Close"})]),(0,s.Lk)("div",ta,[(0,s.Lk)("div",aa,[(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",la,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.active_racers,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"list-group-item d-flex justify-content-between align-items-center"},[(0,s.Lk)("div",ra,[sa,(0,s.Lk)("div",na,[(0,s.Lk)("a",{href:e.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)],8,oa),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",ia,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",ua," None"))])])])))),128))])])])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",ca,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.bench_racers,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"list-group-item list-group-item-secondary d-flex justify-content-between align-items-center"},[(0,s.Lk)("div",da,[pa,(0,s.Lk)("div",ga,[(0,s.Lk)("a",{href:e.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)],8,va),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",ka,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",ha," None"))])]),ma])))),128))])])])])])])])])])],8,Jt),(0,s.Lk)("td",null,[(0,s.Lk)("button",{type:"button",class:"btn btn-link p-0 m-0","data-bs-toggle":"modal","data-bs-target":"#"+a.id},(0,d.v_)(a.current_score),9,ya)]),(0,s.Lk)("div",{class:"modal fade",id:a.id,tabindex:"-1","aria-labelledby":"exampleModalLabel2","aria-hidden":"true"},[(0,s.Lk)("div",fa,[(0,s.Lk)("div",_a,[(0,s.Lk)("div",ba,[(0,s.Lk)("h1",wa,"Scores for "+(0,d.v_)(a.player_nickname),1),Ca]),(0,s.Lk)("div",Ea,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.stage_scores,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},[(0,s.Lk)("h2",null,[(0,s.Lk)("a",{href:e.stage_url,target:"prosite"},(0,d.v_)(g.value.get(e.stage_url)[0].name),9,Ra)]),(0,s.Lk)("table",Aa,[xa,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.racers,(t=>((0,s.uX)(),(0,s.CE)("tr",{key:t.url},[(0,s.Lk)("td",null,[(0,s.Lk)("b",null,(0,d.v_)(t.name),1),i.value.get(e.stage_url)?((0,s.uX)(),(0,s.CE)("span",Xa,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value.get(e.stage_url).get(t.url),(e=>((0,s.uX)(),(0,s.CE)("span",{key:e},["white"===e.category?((0,s.uX)(),(0,s.CE)("span",Sa,Ta)):(0,s.Q3)("",!0),"yellow"===e.category?((0,s.uX)(),(0,s.CE)("span",Fa,Pa)):(0,s.Q3)("",!0),"green"===e.category?((0,s.uX)(),(0,s.CE)("span",$a,Da)):(0,s.Q3)("",!0),"polkadot"===e.category?((0,s.uX)(),(0,s.CE)("span",Ma,ja)):(0,s.Q3)("",!0)])))),128))])):(0,s.Q3)("",!0)]),(0,s.Lk)("td",null,[i.value.get(e.stage_url)?((0,s.uX)(),(0,s.CE)("div",Wa,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value.get(e.stage_url).get(t.url),(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},[["white","yellow","green","polkadot"].includes(e.category)?0!==e.point?((0,s.uX)(),(0,s.CE)("span",za,(0,d.v_)(e.point),1)):(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("span",Na,(0,d.v_)(e.point),1))])))),128))])):(0,s.Q3)("",!0)]),(0,s.Lk)("td",null,[i.value.get(e.stage_url)?((0,s.uX)(),(0,s.CE)("div",Va,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value.get(e.stage_url).get(t.url),(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},[["white","yellow","green","polkadot"].includes(e.category)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("span",Oa,(0,d.v_)(isNaN(e.category)?e.category:e.category+(e.category%10==1&&e.category%100!=11?"st":e.category%10==2&&e.category%100!=12?"nd":e.category%10==3&&e.category%100!=13?"rd":"th")),1))])))),128))])):(0,s.Q3)("",!0)])])))),128)),(0,s.Lk)("tr",Ha,[Qa,(0,s.Lk)("td",null,(0,d.v_)(e.total_score),1),Ua])])])])))),128))])])])],8,La)])))),128))])])])):(0,s.Q3)("",!0)}};const Ya=(0,Y.A)(Ja,[["__scopeId","data-v-ed29272a"]]);var Ga=Ya;const Za={class:"container mt-4"},el=(0,s.Lk)("h1",{class:"mt-4"},"Preview",-1),tl={class:"row"},al={class:"card-body"},ll={class:"card-title"},rl=(0,s.Lk)("td",null,"Active Race:",-1),sl=["href"],nl=(0,s.Lk)("td",null,"Number of Players:",-1);var ol={__name:"LeaguePreview",setup(e){const t=k(),a=(0,s.EW)((()=>t.allLeagues));return(0,s.sV)((()=>{t.getLeagueList()})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",Za,[el,(0,s.Lk)("div",tl,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"card",style:{width:"18rem"}},[(0,s.Lk)("div",al,[(0,s.Lk)("h5",ll,[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)]),(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[rl,(0,s.Lk)("td",null,[(0,s.Lk)("a",{href:e.active_race_url,target:"prosite"},(0,d.v_)(e.activeRace),9,sl)])]),(0,s.Lk)("tr",null,[nl,(0,s.Lk)("td",null,[(0,s.Lk)("p",null,(0,d.v_)(e.players.length),1)])])]),(0,s.Lk)("div",null,[(0,s.bF)(Ga,{leagueId:e.id},null,8,["leagueId"])])])])))),128))])]))}};const il=ol;var ul=il;const cl=e=>((0,s.Qi)("data-v-05887c48"),e=e(),(0,s.jt)(),e),dl=cl((()=>(0,s.Lk)("h1",{class:"mt-4"},"Draft List",-1))),pl={class:"d-flex justify-content-center mt-3"},gl={class:"list-group"},vl=["onDragstart","onDragenter"],kl={class:"d-flex align-items-center flex-grow-1"},hl=cl((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),ml={class:"content-wrapper"},yl=["href"],Ll={key:0},fl={key:1},_l={class:"btn-group ms-2",role:"group","aria-label":"Basic example"},bl={class:"border-end"},wl=["onClick","disabled"],Cl=["onClick","disabled"],El=["onClick","disabled"];var Rl={__name:"DraftListView",setup(e){const t=k(),a=v(),r=(0,c.KR)(t.league),n=(0,s.EW)((()=>a.racers)),o=a.loadDraftlist,i=(0,c.KR)("");function u(e,t){i.value=t.name}function p(e,t){console.log("start dragging "+t.name),e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("racerName",t.name)}function g(e){let t=e.dataTransfer.getData("racerName");i.value!=t&&a.insertBefore(t,i.value),i.value="",e.preventDefault()}function h(){a.updateDraftlist(r.value.active_race_url)}return(0,s.sV)((()=>{o(r.value.active_race_url)})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[dl,(0,s.eW)(" "+(0,d.v_)(i.value)+" ",1),(0,s.Lk)("div",pl,[(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,[(0,s.Lk)("button",{class:"btn btn-success btn-lg mb-3 me-3",onClick:h},"Save")])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,[(0,s.Lk)("div",{onDrop:t[0]||(t[0]=e=>g(e)),class:"drop-zone",onDragover:t[1]||(t[1]=(0,l.D$)((()=>{}),["prevent"]))},[(0,s.Lk)("ul",gl,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:e,class:"list-group-item d-flex justify-content-between align-items-center",draggable:"true",onDragstart:t=>p(t,e),onDragenter:t=>u(t,e)},[(0,s.Lk)("div",kl,[hl,(0,s.Lk)("div",ml,[(0,s.Lk)("a",{href:e.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)],8,yl),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",Ll,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",fl," None"))])]),(0,s.Lk)("div",_l,[(0,s.Lk)("div",bl,[(0,s.Lk)("button",{onClick:e=>(0,c.R1)(a).move(t,"up"),type:"button",class:"btn btn-success",disabled:0===t},"↑",8,wl)]),(0,s.Lk)("div",null,[(0,s.Lk)("button",{onClick:e=>(0,c.R1)(a).move(t,"down"),type:"button",class:"btn btn-success",disabled:t===n.value.length-1},"↓",8,Cl)]),(0,s.Lk)("div",null,[(0,s.Lk)("button",{onClick:e=>(0,c.R1)(a).move(t,"top"),type:"button",class:"btn btn-success",disabled:0===t},"top",8,El)])])],40,vl)))),128))])],32)])])])])]))}};const Al=(0,Y.A)(Rl,[["__scopeId","data-v-05887c48"]]);var xl=Al;const Xl=e=>((0,s.Qi)("data-v-282426c4"),e=e(),(0,s.jt)(),e),Sl=Xl((()=>(0,s.Lk)("h1",{class:"mt-4"},"My Roster",-1))),Il={class:"d-flex justify-content-center mt-3"},Tl=["disabled"],Fl={class:"list-group"},Kl=["onDragstart"],Pl={class:"d-flex align-items-center"},$l=Xl((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),Bl={class:"content-wrapper"},Dl=["href"],Ml={key:0},ql={key:1},jl={class:"btn-group ms-2",role:"group","aria-label":"Basic example"},Wl=["onClick"],Nl={class:"list-group"},zl=["onDragstart"],Vl={class:"d-flex align-items-center"},Ol=Xl((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),Hl={class:"content-wrapper"},Ql=["href"],Ul={key:0},Jl={key:1},Yl={class:"btn-group ms-2",role:"group","aria-label":"Basic example"},Gl={class:"border-end"},Zl=["onClick"];var er={__name:"RosterView",setup(e){const t=k(),a=(0,s.EW)((()=>t.leaguePlayer.active_racers?t.leaguePlayer.active_racers:[])),r=(0,s.EW)((()=>t.leaguePlayer.bench_racers?t.leaguePlayer.bench_racers:[]));function n(e,t){e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("racerName",t.name)}function o(e,a){const l=e.dataTransfer.getData("racerName");t.moveRoaster(l,a),e.preventDefault()}return(e,i)=>{const u=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",null,[Sl,(0,s.Lk)("div",Il,[(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,[(0,s.Lk)("button",{class:"btn btn-success btn-lg mb-3 me-3",onClick:i[0]||(i[0]=e=>(0,c.R1)(t).submitRoaster()),disabled:8!=a.value.length||(new Date).getHours()>5&&(new Date).getHours()<13},"Save",8,Tl),(0,s.bF)(u,{class:"btn btn-outline-success btn-lg mb-3",to:"/trade"},{default:(0,s.k6)((()=>[(0,s.eW)("Trade")])),_:1})])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,[(0,s.Lk)("div",{onDrop:i[1]||(i[1]=e=>o(e,"active")),onDragover:i[2]||(i[2]=(0,l.D$)((()=>{}),["prevent"]))},[(0,s.Lk)("ul",Fl,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"list-group-item d-flex justify-content-between align-items-center",draggable:"true",onDragstart:t=>n(t,e)},[(0,s.Lk)("div",Pl,[$l,(0,s.Lk)("div",Bl,[(0,s.Lk)("a",{href:e.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)],8,Dl),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",Ml,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",ql," None"))])]),(0,s.Lk)("div",jl,[(0,s.Lk)("div",null,[(0,s.Lk)("button",{onClick:a=>(0,c.R1)(t).moveRoaster(e.name,"bench"),type:"button",class:"btn btn-success"},"↓",8,Wl)])])],40,Kl)))),128))])],32)])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,[(0,s.Lk)("div",{onDrop:i[3]||(i[3]=e=>o(e,"bench")),class:"drop-zone",onDragover:i[4]||(i[4]=(0,l.D$)((()=>{}),["prevent"]))},[(0,s.Lk)("ul",Nl,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"list-group-item list-group-item-secondary d-flex justify-content-between align-items-center",draggable:"true",onDragstart:t=>n(t,e)},[(0,s.Lk)("div",Vl,[Ol,(0,s.Lk)("div",Hl,[(0,s.Lk)("a",{href:e.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)],8,Ql),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",Ul,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",Jl," None"))])]),(0,s.Lk)("div",Yl,[(0,s.Lk)("div",Gl,[(0,s.Lk)("button",{onClick:a=>(0,c.R1)(t).moveRoaster(e.name,"active"),type:"button",class:"btn btn-success"},"↑",8,Zl)])])],40,zl)))),128))])],32)])])])])])}}};const tr=(0,Y.A)(er,[["__scopeId","data-v-282426c4"]]);var ar=tr;const lr=e=>((0,s.Qi)("data-v-b3c3a2f2"),e=e(),(0,s.jt)(),e),rr=lr((()=>(0,s.Lk)("h1",null,"League",-1))),sr=lr((()=>(0,s.Lk)("td",null,"League Id",-1))),nr=lr((()=>(0,s.Lk)("td",null,"League Name",-1))),or=lr((()=>(0,s.Lk)("td",null,"Active Race",-1))),ir=["href"],ur=lr((()=>(0,s.Lk)("h2",null,"Player Draft Lists",-1))),cr=["disabled"],dr=["disabled"];var pr={__name:"RunDraftView",setup(e){const t=k(),a=v(),l=(0,c.KR)(t.league),r=(0,s.EW)((()=>t.players)),n=(0,s.EW)((()=>a.draftList)),o=a.getAllDraftlist;function i(){t.shuffle(),o(l.value.id),u.value=1}(0,s.sV)((()=>{o(l.value.id)}));const u=(0,c.KR)(1);function p(){if(13==u.value)return;const e=n.value,t=u.value%2==1?e:e.slice().reverse();t.forEach((e=>{let a=e.racer_list.find((e=>!e.player));t.forEach((t=>{let l=t.racer_list.find((e=>e.name==a.name));l.player=e.user_strava_id.toString()}))})),u.value++}function g(){const e=r.value,a=n.value;e.forEach(((e,t)=>{const l=a[t].racer_list.filter((t=>t.player==e.player_strava_id));console.log(e.player_nickname+": "+l.length),e.active_racers=l.slice(0,8),e.bench_racers=l.slice(8)})),t.submitDraft()}function h(e,t){return e.player?e.player==t.user_strava_id?"own":"taken":""}return(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[rr,(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[sr,(0,s.Lk)("td",null,(0,d.v_)(l.value.id),1)]),(0,s.Lk)("tr",null,[nr,(0,s.Lk)("td",null,(0,d.v_)(l.value.name),1)]),(0,s.Lk)("tr",null,[or,(0,s.Lk)("td",null,[(0,s.Lk)("a",{href:l.value.active_race_url,target:"prosite"},(0,d.v_)(l.value.activeRace),9,ir)])])]),ur,(0,s.Lk)("button",{onClick:t[0]||(t[0]=e=>i())},"Randomize Draft Order "),(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>p()),disabled:u.value>12},"Draft! "+(0,d.v_)(u.value),9,cr),(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>g()),disabled:13!=u.value},"Submit Draft Result",8,dr),(0,s.Lk)("table",null,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,(e=>((0,s.uX)(),(0,s.CE)("th",{key:e.player_strava_id},(0,d.v_)(e.player_nickname),1)))),128))])]),(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value,(e=>((0,s.uX)(),(0,s.CE)("td",{key:e},[(0,s.Lk)("div",null,(0,d.v_)(e.user_strava_id),1),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.racer_list,(t=>((0,s.uX)(),(0,s.CE)("div",{key:t},[(0,s.Lk)("span",{class:(0,d.C4)(h(t,e))},(0,d.v_)(t.name),3),(0,s.Lk)("span",null,"["+(0,d.v_)(t.player)+"]",1)])))),128))])))),128))])])])]))}};const gr=(0,Y.A)(pr,[["__scopeId","data-v-b3c3a2f2"]]);var vr=gr;const kr=e=>((0,s.Qi)("data-v-7fa8c3a8"),e=e(),(0,s.jt)(),e),hr={class:"d-flex justify-content-center mt-4"},mr=kr((()=>(0,s.Lk)("h1",null,"Trade Requests",-1))),yr={class:"list-group"},Lr={class:"d-flex align-items-center flex-grow-1"},fr=kr((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),_r={class:"content-wrapper"},br=["href"],wr={key:0},Cr={key:1},Er={class:"text-end ms-3"},Rr=kr((()=>(0,s.Lk)("div",null,"Requested by:",-1))),Ar={class:"fw-bold"},xr={class:"ms-5"},Xr=["onClick"],Sr=kr((()=>(0,s.Lk)("h1",{class:"text-center mt-4"},"Trade",-1))),Ir={class:"container mt-3"},Tr={class:"row justify-content-center align-items-center"},Fr={class:"col-md-6"},Kr={class:"text-center mb-3"},Pr={class:"text-center"},$r=["disabled"],Br={class:"container"},Dr={class:"row"},Mr={class:"col-md-6"},qr=kr((()=>(0,s.Lk)("h2",null,"Your Roster",-1))),jr={class:"list-group"},Wr=["onClick"],Nr={class:"d-flex align-items-center flex-grow-1"},zr=kr((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),Vr={class:"content-wrapper"},Or=["href"],Hr={key:0},Qr={key:1},Ur=["onClick"],Jr={class:"d-flex align-items-center flex-grow-1"},Yr=kr((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),Gr={class:"content-wrapper"},Zr=["href"],es={key:0},ts={key:1},as={class:"col-md-6"},ls=kr((()=>(0,s.Lk)("h2",null,"Available Racers",-1))),rs={class:"list-group"},ss=["onClick"],ns={class:"d-flex align-items-center flex-grow-1"},os=kr((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),is={class:"content-wrapper"},us=["href"],cs={key:0},ds={key:1};var ps={__name:"TradeView",setup(e){const t=k(),a=(0,c.KR)(t.league),r=(0,s.EW)((()=>t.leaguePlayer.active_racers)),n=(0,s.EW)((()=>t.leaguePlayer.bench_racers)),o=v(),i=(0,s.EW)((()=>o.allRacers.filter((e=>!e.player)))),u=(0,c.KR)({}),p=(0,c.KR)({});function g(e){u.value=e}function h(e){p.value=e}const m=(0,s.EW)((()=>t.tradeList.slice().filter((e=>e.player_strava_id==t.leaguePlayer.player_strava_id))));return(0,s.sV)((async()=>{await o.getRacerlist(a.value.active_race_url),await t.getTradeRequests()})),(e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",hr,[(0,s.bo)((0,s.Lk)("div",null,[mr,(0,s.Lk)("ul",yr,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(m.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e,class:"list-group-item d-flex justify-content-between align-items-center"},[(0,s.Lk)("div",Lr,[fr,(0,s.Lk)("div",_r,[(0,s.Lk)("a",{href:e.toRacer.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.toRacer.name),1)],8,br),e.toRacer.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",wr,(0,d.v_)(e.toRacer.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",Cr,"None"))])]),(0,s.Lk)("div",Er,[Rr,(0,s.Lk)("div",Ar,(0,d.v_)((0,c.R1)(t).getPlayerByStravaId(e.player_strava_id).player_nickname),1)]),(0,s.Lk)("div",xr,[(0,s.Lk)("button",{type:"button",class:"btn btn-success",onClick:a=>(0,c.R1)(t).cancelTradeRequest(e.id)}," Cancel ",8,Xr)])])))),128))])],512),[[l.aG,m.value.length]])]),(0,s.Lk)("div",null,[Sr,(0,s.Lk)("div",null,"Your current trade priority is "+(0,d.v_)((0,c.R1)(t).league.players.indexOf((0,c.R1)(t).leaguePlayer.player_strava_id)+1)+" of "+(0,d.v_)((0,c.R1)(t).league.players.length),1),(0,s.Lk)("div",Ir,[(0,s.Lk)("div",Tr,[(0,s.Lk)("div",Fr,[(0,s.Lk)("div",Kr,[(0,s.Lk)("div",null,[(0,s.Lk)("strong",null,(0,d.v_)(u.value.name)+" >> "+(0,d.v_)(p.value.name),1)])]),(0,s.Lk)("div",Pr,[(0,s.Lk)("button",{class:"btn btn-success btn-lg mb-3 me-3",onClick:a[0]||(a[0]=e=>(0,c.R1)(t).submitTrade(u.value,p.value)),disabled:!(u.value.name&&p.value.name)},"Submit",8,$r)])])])]),(0,s.Lk)("div",Br,[(0,s.Lk)("div",Dr,[(0,s.Lk)("div",Mr,[qr,(0,s.Lk)("ul",jr,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.name,class:(0,d.C4)(["list-group-item d-flex justify-content-between align-items-center",{"border-success-thick":u.value===e}]),onClick:t=>g(e)},[(0,s.Lk)("div",Nr,[zr,(0,s.Lk)("div",Vr,[(0,s.Lk)("a",{href:e.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)],8,Or),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",Hr,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",Qr,"None"))])])],10,Wr)))),128)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.name,class:(0,d.C4)(["list-group-item d-flex justify-content-between align-items-center",{"border-success-thick":u.value===e}]),onClick:t=>g(e)},[(0,s.Lk)("div",Jr,[Yr,(0,s.Lk)("div",Gr,[(0,s.Lk)("a",{href:e.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)],8,Zr),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",es,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",ts,"None"))])])],10,Ur)))),128))])]),(0,s.Lk)("div",as,[ls,(0,s.Lk)("ul",rs,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.name,class:(0,d.C4)(["list-group-item d-flex justify-content-between align-items-center",{"border-success-thick":p.value===e}]),onClick:t=>h(e)},[(0,s.Lk)("div",ns,[os,(0,s.Lk)("div",is,[(0,s.Lk)("a",{href:e.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)],8,us),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",cs,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",ds,"None"))])])],10,ss)))),128))])])])])])],64))}};const gs=(0,Y.A)(ps,[["__scopeId","data-v-7fa8c3a8"]]);var vs=gs;const ks=e=>((0,s.Qi)("data-v-73cbd394"),e=e(),(0,s.jt)(),e),hs=ks((()=>(0,s.Lk)("h1",null,"Run Trade",-1))),ms=ks((()=>(0,s.Lk)("td",null,"League Id",-1))),ys=ks((()=>(0,s.Lk)("td",null,"League Name",-1))),Ls=ks((()=>(0,s.Lk)("td",null,"Active Race",-1))),fs=["href"],_s=ks((()=>(0,s.Lk)("td",null,[(0,s.Lk)("h2",null,"Trade Requests")],-1))),bs=ks((()=>(0,s.Lk)("span",null," >> ",-1)));var ws={__name:"RunTrade",setup(e){const t=k(),a=(0,c.KR)(t.league),l=(0,s.EW)((()=>t.tradeList)),r=N(),n=(0,W.rd)();return(0,s.sV)((async()=>{await t.getMultiTradeRequests(),r.isAutoMode&&r.currentTask&&(t.tradeList.length>0&&await t.completeTradeRequests(),r.completeTask(),n.push("/autocenter"))})),(e,r)=>((0,s.uX)(),(0,s.CE)("div",null,[hs,(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[ms,(0,s.Lk)("td",null,(0,d.v_)(a.value.id),1)]),(0,s.Lk)("tr",null,[ys,(0,s.Lk)("td",null,(0,d.v_)(a.value.name),1)]),(0,s.Lk)("tr",null,[Ls,(0,s.Lk)("td",null,[(0,s.Lk)("a",{href:a.value.active_race_url,target:"prosite"},(0,d.v_)(a.value.activeRace),9,fs)])]),(0,s.Lk)("tr",null,[_s,(0,s.Lk)("td",null,[(0,s.Lk)("button",{onClick:r[0]||(r[0]=(...e)=>(0,c.R1)(t).completeTradeRequests&&(0,c.R1)(t).completeTradeRequests(...e))}," Finalize Trade ")])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:(0,d.C4)(e.selected?"own":"")},[(0,s.Lk)("span",null,(0,d.v_)(e.toRacer.name)+" ["+(0,d.v_)(e.toRacer.ranking)+"]",1),(0,s.eW)(),bs,(0,s.Lk)("span",null,(0,d.v_)(e.fromRacer.name)+" ["+(0,d.v_)(e.fromRacer.ranking)+"]",1),(0,s.eW)(" by "),(0,s.Lk)("span",null,(0,d.v_)((0,c.R1)(t).getPlayerByStravaId(e.player_strava_id).player_nickname),1),(0,s.Lk)("span",null," ["+(0,d.v_)((0,c.R1)(t).getPlayerPositionByStravaId(e.player_strava_id))+"]",1)],2)))),128))])])])]))}};const Cs=(0,Y.A)(ws,[["__scopeId","data-v-73cbd394"]]);var Es=Cs;const Rs=(0,s.Lk)("h1",null,"Score by Stage",-1),As=["value"],xs=(0,s.Lk)("h2",null,"Racer Scores",-1),Xs={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ss={class:"modal-dialog"},Is={class:"modal-content"},Ts=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"League Info"),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Fs={class:"modal-body"},Ks=(0,s.Lk)("td",null,"Id",-1),Ps=(0,s.Lk)("td",null,"Name",-1),$s=(0,s.Lk)("td",null,"Password",-1),Bs=(0,s.Lk)("td",null,"Active Race",-1),Ds=["href"],Ms={class:"table"},qs=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{scope:"col"},"Cat"),(0,s.Lk)("th",{scope:"col"},"Racer"),(0,s.Lk)("th",{scope:"col"},"Points")])],-1),js=(0,s.Lk)("h2",null,"Player scores",-1),Ws={style:{color:"red"}};var Ns={__name:"RunScoresView",setup(e){const t=k(),a=v(),r=(0,c.KR)(t.league),n=t.getLeaguePlayers,o=(0,c.KR)(t.race.days),i=(0,c.KR)(""),u=t.getRaceScoreByStage,g=(0,s.EW)((()=>t.scoresForStage.slice())),h=async()=>{const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/pcs?url=${i.value}`,{headers:{Authorization:`Bearer ${e}`}});let a=document.createElement("html");a.innerHTML=t.data;let l=r.value.active_race_url,s=new Map;a.querySelectorAll(".restabs li").forEach((e=>s.set(e.childNodes[0].textContent,e.childNodes[0].getAttribute("data-id")))),s.get("Stage")||s.set("Stage",s.get(""));const n=!Array.from(a.querySelectorAll(".prevNextStageLink a")).slice(-1)[0].innerHTML.startsWith("next");let o=[];const c=Array.from(a.querySelectorAll('div[data-id="'+s.get("Stage")+'"] table.results thead th'),(({innerHTML:e})=>e));a.querySelectorAll('div[data-id="'+s.get("Stage")+'"] table.results tbody tr').forEach((e=>{if(e.firstChild.textContent&&e.children[10].textContent){let t={};t.racer=e.children[c.indexOf("Rider")].firstChild.children[1].href,t.racer&&(t.racer=t.racer.replace(document.location.origin,"https://www.procyclingstats.com")),t.race=l,t.category=e.firstChild.textContent,t.point=e.children[c.indexOf("Pnt")].textContent,t.stage=i.value,o.push(t)}}));const d=Array.from(a.querySelectorAll('div[data-id="'+s.get("GC")+'"] table.results thead th'),(({innerHTML:e})=>e));let g={};if(g.racer=a.querySelector('div[data-id="'+s.get("GC")+'"] table.results tbody tr').children[d.indexOf("Rider")].firstChild.children[1].href,g.racer&&(g.racer=g.racer.replace(document.location.origin,"https://www.procyclingstats.com")),g.race=l,g.category="yellow",g.point=0,g.stage=i.value,o.push(g),n){let e=[100,70,50,40,32,26,22,18,14,10,8,6,4,2,1];a.querySelector('div[data-id="'+s.get("GC")+'"] table.results').querySelectorAll("tbody tr").forEach(((t,a)=>{if(a<15){let r={};r.racer=t.children[d.indexOf("Rider")].firstChild.children[1].href,r.racer&&(r.racer=r.racer.replace(document.location.origin,"https://www.procyclingstats.com")),r.race=l,r.category="gc#"+(a+1),r.point=e[a],r.stage=i.value,o.push(r)}}));const t=Array.from(a.querySelectorAll('div[data-id="'+s.get("Youth")+'"] table.results thead th'),(({innerHTML:e})=>e));let r=[30,20,10];a.querySelector('div[data-id="'+s.get("Youth")+'"] table.results').querySelectorAll("tbody tr").forEach(((e,a)=>{if(a<3){let s={};s.racer=e.children[t.indexOf("Rider")].firstChild.children[1].href,s.racer&&(s.racer=s.racer.replace(document.location.origin,"https://www.procyclingstats.com")),s.race=l,s.category="youth#"+(a+1),s.point=r[a],s.stage=i.value,o.push(s)}}))}const v=Array.from(a.querySelectorAll('div[data-id="'+s.get("Points")+'"] table.results thead th'),(({innerHTML:e})=>e));a.querySelector('div[data-id="'+s.get("Points")+'"] table.results').querySelectorAll("tbody tr").forEach((e=>{if(e.lastChild.firstChild.textContent.indexOf("-")<0){let t={};t.racer=e.children[v.indexOf("Rider")].firstChild.children[1].href,t.racer&&(t.racer=t.racer.replace(document.location.origin,"https://www.procyclingstats.com")),t.race=l,t.category="sprint",t.point=e.lastChild.firstChild.textContent.substring(1),t.stage=i.value,o.push(t)}})),g={},g.racer=a.querySelector('div[data-id="'+s.get("Points")+'"] table.results tbody tr').children[v.indexOf("Rider")].firstChild.children[1].href,g.racer&&(g.racer=g.racer.replace(document.location.origin,"https://www.procyclingstats.com")),g.race=l,g.category="green",g.point=0,g.stage=i.value,o.push(g);const k=Array.from(a.querySelectorAll('div[data-id="'+s.get("KOM")+'"] table.results thead th'),(({innerHTML:e})=>e));a.querySelector('div[data-id="'+s.get("KOM")+'"] table.results').querySelectorAll("tbody tr").forEach((e=>{if(e.lastChild.firstChild.textContent.indexOf("-")<0){let t={};t.racer=e.children[k.indexOf("Rider")].firstChild.children[1].href,t.racer&&(t.racer=t.racer.replace(document.location.origin,"https://www.procyclingstats.com")),t.race=l,t.category="KOM",t.point=e.lastChild.firstChild.textContent.substring(1),t.stage=i.value,o.push(t)}})),g={},g.racer=a.querySelector('div[data-id="'+s.get("KOM")+'"] table.results tbody tr').children[k.indexOf("Rider")].firstChild.children[1].href,g.racer&&(g.racer=g.racer.replace(document.location.origin,"https://www.procyclingstats.com")),g.race=l,g.category="polkadot",g.point=0,g.stage=i.value,o.push(g),g={};const h=Array.from(a.querySelectorAll('div[data-id="'+s.get("Youth")+'"] table.results thead th'),(({innerHTML:e})=>e));g.racer=a.querySelector('div[data-id="'+s.get("Youth")+'"] table.results tbody tr').children[h.indexOf("Rider")].firstChild.children[1].href,g.racer&&(g.racer=g.racer.replace(document.location.origin,"https://www.procyclingstats.com")),g.race=l,g.category="white",g.point=0,g.stage=i.value,o.push(g),await p.A.put("https://www.tourdefantasy.com/racerScore/loadscores",o).then((function(e){console.log(e)})),u(i.value)},m=N(),y=(0,W.rd)();return(0,s.sV)((async()=>{await a.getRacerlist(r.value.active_race_url),await n(r.value.id),await t.getRace(),m.isAutoMode&&m.currentTask?(console.log("auto: "+m.currentTask),m.currentTask.data&&m.currentTask.data.stageURL&&(i.value=m.currentTask.data.stageURL,await u(i.value),await h(),await t.submitStageScore(i),m.completeTask(),y.push("/autocenter"))):(i.value=o.value[0].url,u(i.value))})),(e,a)=>((0,s.uX)(),(0,s.CE)("div",null,[Rs,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),onChange:a[1]||(a[1]=e=>(0,c.R1)(u)(i.value))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.value,(e=>((0,s.uX)(),(0,s.CE)("option",{value:e.url,key:e},(0,d.v_)(e.name),9,As)))),128))],544),[[l.u1,i.value]]),(0,s.Lk)("button",{type:"button",onClick:h}," Retrieve Scores"),xs,(0,s.Lk)("div",Xs,[(0,s.Lk)("div",Ss,[(0,s.Lk)("div",Is,[Ts,(0,s.Lk)("div",Fs,[(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[Ks,(0,s.Lk)("td",null,(0,d.v_)(r.value.id),1)]),(0,s.Lk)("tr",null,[Ps,(0,s.Lk)("td",null,(0,d.v_)(r.value.name),1)]),(0,s.Lk)("tr",null,[$s,(0,s.Lk)("td",null,(0,d.v_)(r.value.password),1)]),(0,s.Lk)("tr",null,[Bs,(0,s.Lk)("td",null,[(0,s.Lk)("a",{href:r.value.active_race_url,target:"prosite"},(0,d.v_)(r.value.activeRace),9,Ds)])])])])])])]),(0,s.Lk)("table",Ms,[qs,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(g.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e},[(0,s.Lk)("td",null,(0,d.v_)(e.category),1),(0,s.Lk)("td",null,(0,d.v_)(e.racer),1),(0,s.Lk)("td",null,(0,d.v_)(e.point),1)])))),128))])]),js,(0,s.Lk)("button",{onClick:a[2]||(a[2]=e=>(0,c.R1)(t).submitStageScore(i.value))},"Submit"),(0,s.Lk)("table",null,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,c.R1)(t).stagePlayers,(e=>((0,s.uX)(),(0,s.CE)("th",{key:e},(0,d.v_)(e.player_nickname),1)))),128))])]),(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,c.R1)(t).stagePlayers,(e=>((0,s.uX)(),(0,s.CE)("td",{key:e},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.stageRacers,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},[(0,s.Lk)("div",null,[(0,s.Lk)("b",null,(0,d.v_)(e.name),1)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.scores,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},(0,d.v_)(e.category)+": "+(0,d.v_)(e.point),1)))),128))])))),128)),(0,s.Lk)("div",Ws,(0,d.v_)(e.stageScore),1),(0,s.Lk)("div",null,(0,d.v_)(e.jerseys),1)])))),128))])])])]))}};const zs=Ns;var Vs=zs;const Os=(0,s.Lk)("h1",null,"By Pass",-1),Hs={class:"container px-4 text-center"},Qs={class:"row gx-5 mb-3"},Us={class:"col"},Js=(0,s.Lk)("label",{for:"inputPassword",class:"form-label"},"User Id",-1),Ys={class:"row gx-5"},Gs={class:"col"};var Zs={__name:"ByPass",setup(e){const t=g(),a=k(),r=(0,W.rd)(),n=(0,c.KR)(""),o=async()=>{await t.impersonate(n.value),t.user.current_league_id?(await a.loadLeague(t.user.current_league_id),r.push({name:"LeagueHome"})):r.push({name:"JoinLeague"})};return(0,s.sV)((()=>{})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[Os,(0,s.Lk)("form",null,[(0,s.Lk)("div",Hs,[(0,s.Lk)("div",Qs,[(0,s.Lk)("div",Us,[Js,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),class:"form-control",id:"inputPassword","aria-describedby":"emailHelp"},null,512),[[l.Jo,n.value]])])])]),(0,s.Lk)("div",Ys,[(0,s.Lk)("div",Gs,[(0,s.Lk)("button",{onClick:(0,l.D$)(o,["prevent"]),class:"btn btn-primary"},"Impersonate")])])])]))}};const en=Zs;var tn=en;const an=(0,s.Lk)("h1",{class:"mt-4"},"Scores",-1),ln=["href"],rn={class:"table"},sn=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{scope:"col"},"Racer"),(0,s.Lk)("th",{scope:"col"},"Points Earned"),(0,s.Lk)("th",{scope:"col"},"How Earned")])],-1),nn={key:0},on=["src"],un={key:0},cn={key:0},dn={key:1},pn={key:0},gn={key:0},vn={key:0},kn={key:1},hn={class:"border-bottom border-2"},mn=(0,s.Lk)("th",{scope:"row"},"Total",-1),yn=(0,s.Lk)("td",null,null,-1);var Ln={__name:"DetailScoresView",setup(e){const t=k(),a=(0,c.KR)(t.league),l=(0,s.EW)((()=>{const e=new URLSearchParams(window.location.search),a=e.get("userId"),l=t.players.find((e=>(console.log(e.player_strava_id),e.player_strava_id==a)));return l})),r=(0,c.KR)([]),n=(0,c.KR)(new Map),o=async()=>{const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/racerScore/search?race=${a.value.active_race_url}`,{headers:{Authorization:`Bearer ${e}`}});r.value=t.data;let l=Map.groupBy(r.value,(({stage:e})=>e));l.forEach(((e,t,a)=>{a.set(t,Map.groupBy(e,(({racer:e})=>e)))})),n.value=l},i=(0,s.EW)((()=>Map.groupBy(t.race.days,(({url:e})=>e)))),u=t.getLeaguePlayers;return(0,s.sV)((async()=>{await u(a.value.id),await t.getRace(),await o()})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[an,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value.stage_scores,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},[(0,s.Lk)("h2",null,[(0,s.Lk)("a",{href:e.stage_url,target:"prosite"},(0,d.v_)(i.value.get(e.stage_url)[0].name),9,ln)]),(0,s.Lk)("table",rn,[sn,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.racers,(t=>((0,s.uX)(),(0,s.CE)("tr",{key:t.url},[(0,s.Lk)("td",null,[(0,s.Lk)("b",null,(0,d.v_)(t.name),1),n.value.get(e.stage_url)?((0,s.uX)(),(0,s.CE)("span",nn,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value.get(e.stage_url).get(t.url),(e=>((0,s.uX)(),(0,s.CE)("span",{key:e},[["white","yellow","polkadot","green","1","2","3","youth#1","youth#2","youth#3","gc#1","gc#2","gc#3"].includes(e.category)?((0,s.uX)(),(0,s.CE)("img",{key:0,src:"/"+e.category.replace("#","_")+".png",style:{width:"20px",height:"20px"}},null,8,on)):(0,s.Q3)("",!0)])))),128))])):(0,s.Q3)("",!0)]),(0,s.Lk)("td",null,[n.value.get(e.stage_url)?((0,s.uX)(),(0,s.CE)("div",un,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value.get(e.stage_url).get(t.url),(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},[["white","yellow","green","polkadot"].includes(e.category)?0!==e.point?((0,s.uX)(),(0,s.CE)("span",dn,(0,d.v_)(e.point),1)):(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("span",cn,(0,d.v_)(e.point),1))])))),128))])):(0,s.Q3)("",!0)]),(0,s.Lk)("td",null,[n.value.get(e.stage_url)?((0,s.uX)(),(0,s.CE)("div",pn,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value.get(e.stage_url).get(t.url),(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},[["white","yellow","polkadot","green"].includes(e.category)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",gn,[e.category.includes("#")?((0,s.uX)(),(0,s.CE)("div",vn,[(0,s.Lk)("span",null,(0,d.v_)(e.category.split("#")[0])+" "+(0,d.v_)(isNaN(e.category.split("#")[1])?e.category.split("#")[1]:e.category.split("#")[1]+(e.category.split("#")[1]%10==1&&e.category.split("#")[1]%100!=11?"st":e.category.split("#")[1]%10==2&&e.category.split("#")[1]%100!=12?"nd":e.category.split("#")[1]%10==3&&e.category.split("#")[1]%100!=13?"rd":"th")),1)])):((0,s.uX)(),(0,s.CE)("div",kn,[(0,s.Lk)("span",null,(0,d.v_)(isNaN(e.category)?e.category:e.category+(e.category%10==1&&e.category%100!=11?"st":e.category%10==2&&e.category%100!=12?"nd":e.category%10==3&&e.category%100!=13?"rd":"th")),1)]))]))])))),128))])):(0,s.Q3)("",!0)])])))),128)),(0,s.Lk)("tr",hn,[mn,(0,s.Lk)("td",null,(0,d.v_)(e.total_score),1),yn])])])])))),128))]))}};const fn=Ln;var _n=fn;const bn=e=>((0,s.Qi)("data-v-6fff5f3a"),e=e(),(0,s.jt)(),e),wn={class:"mt-4"},Cn={class:"d-flex justify-content-center mt-3"},En={class:"list-group"},Rn={class:"d-flex align-items-center"},An=bn((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),xn={class:"content-wrapper"},Xn=["href"],Sn={key:0},In={key:1},Tn={class:"list-group"},Fn={class:"d-flex align-items-center"},Kn=bn((()=>(0,s.Lk)("div",{class:"image-parent"},[(0,s.Lk)("img",{src:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image"})],-1))),Pn={class:"content-wrapper"},$n=["href"],Bn={key:0},Dn={key:1},Mn=bn((()=>(0,s.Lk)("div",{class:"btn-group ms-2",role:"group","aria-label":"Basic example"},null,-1)));var qn={__name:"RosterViewOnly",setup(e){const t=k(),a=(0,s.EW)((()=>{const e=new URLSearchParams(window.location.search),a=e.get("userId"),l=t.players.find((e=>(console.log(e.player_strava_id),e.player_strava_id==a)));return l.active_racers=l.active_racers?l.active_racers:[],l.bench_racers_racers=l.bench_racers_racers?l.bench_racers_racers:[],l}));return(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("h1",wn,(0,d.v_)(a.value.player_nickname),1),(0,s.Lk)("div",Cn,[(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",En,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value.active_racers,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"list-group-item d-flex justify-content-between align-items-center"},[(0,s.Lk)("div",Rn,[An,(0,s.Lk)("div",xn,[(0,s.Lk)("a",{href:e.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)],8,Xn),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",Sn,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",In," None"))])])])))),128))])])])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",Tn,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value.bench_racers,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"list-group-item list-group-item-secondary d-flex justify-content-between align-items-center"},[(0,s.Lk)("div",Fn,[Kn,(0,s.Lk)("div",Pn,[(0,s.Lk)("a",{href:e.url,target:"prosite"},[(0,s.Lk)("strong",null,(0,d.v_)(e.name),1)],8,$n),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",Bn,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",Dn," None"))])]),Mn])))),128))])])])])])])]))}};const jn=(0,Y.A)(qn,[["__scopeId","data-v-6fff5f3a"]]);var Wn=jn;const Nn=(0,s.Lk)("h1",{class:"mt-4"},"Full Scores",-1),zn=(0,s.Lk)("span",null,"* available racers",-1),Vn={class:"table"},On=(0,s.Lk)("th",{scope:"col"},"Racer",-1),Hn=(0,s.Lk)("th",{scope:"col"},"Total",-1),Qn={style:{"vertical-align":"middle"}},Un={style:{"vertical-align":"middle"}},Jn={key:0},Yn=["src"],Gn=(0,s.Lk)("img",{src:"/blank.png",style:{width:"1px",height:"20px"}},null,-1),Zn={key:0},eo=["data-bs-target"],to=["id"],ao={key:0},lo={key:0},ro={key:1};var so={__name:"FullScoresView",setup(e){const t=k(),a=(0,c.KR)(t.league),l=(0,c.KR)([]),r=(0,c.KR)(new Map),n=(0,c.KR)([]),o=async()=>{const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/racerScore/search?race=${a.value.active_race_url}`,{headers:{Authorization:`Bearer ${e}`}});l.value=t.data;let s=Map.groupBy(l.value,(({racer:e})=>e)),o=new Map;s.forEach(((e,t)=>{o.set(t,e.reduce(((e,t)=>e+t.point),0))}));let i=Array.from(o,(e=>({url:e[0],point:e[1]})));i.sort(((e,t)=>t.point-e.point)),n.value=i,s.forEach(((e,t,a)=>{let l=Map.groupBy(e,(({stage:e})=>e));a.set(t,l)})),r.value=s},i=(0,s.EW)((()=>{let e=t.race.days.slice().filter((e=>"Restday"!=e.name));return e.sort(((e,t)=>e.seq-t.seq)),e.forEach((e=>{e.shortname=e.url.substring(e.url.lastIndexOf("-")+1)})),e})),u=v(),g=(0,s.EW)((()=>{let e=Map.groupBy(u.allRacers,(({url:e})=>e));return e})),h=t.getLeaguePlayers;return(0,s.sV)((async()=>{await u.getRacerlist(a.value.active_race_url),await h(a.value.id),await t.getRace(),await o()})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[Nn,(0,s.eW)(),zn,(0,s.Lk)("table",Vn,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[On,Hn,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,(e=>((0,s.uX)(),(0,s.CE)("th",{key:e,scope:"col"},(0,d.v_)(e.shortname),1)))),128))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e},[(0,s.Lk)("td",Qn,[(0,s.Lk)("b",null,(0,d.v_)(g.value.get(e.url)[0].name)+" "+(0,d.v_)(g.value.get(e.url)[0].player?"":"*"),1)]),(0,s.Lk)("td",Un,[(0,s.Lk)("b",null,(0,d.v_)(e.point),1)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,((t,a)=>((0,s.uX)(),(0,s.CE)("td",{key:a},[r.value.get(e.url).get(t.url)?((0,s.uX)(),(0,s.CE)("div",Jn,[(0,s.Lk)("div",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value.get(e.url).get(t.url),(e=>((0,s.uX)(),(0,s.CE)("span",{key:e},[["white","yellow","polkadot","green","1","2","3","youth#1","youth#2","youth#3","gc#1","gc#2","gc#3"].includes(e.category)?((0,s.uX)(),(0,s.CE)("img",{key:0,src:"/"+e.category.replace("#","_")+".png",style:{width:"20px",height:"20px"}},null,8,Yn)):(0,s.Q3)("",!0)])))),128)),Gn]),0!=r.value.get(e.url).get(t.url).reduce(((e,t)=>e+t.point),0)?((0,s.uX)(),(0,s.CE)("div",Zn,[(0,s.Lk)("a",{href:"#","data-bs-toggle":"collapse","data-bs-target":"#collapse"+e.url+t.url},(0,d.v_)(r.value.get(e.url).get(t.url).reduce(((e,t)=>e+t.point),0)),9,eo)])):(0,s.Q3)("",!0),(0,s.Lk)("div",{id:"collapse"+e.url+t.url,class:"collapse"},[(0,s.Lk)("div",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value.get(e.url).get(t.url),((e,t)=>((0,s.uX)(),(0,s.CE)("span",{key:t},[["white","yellow","polkadot","green"].includes(e.category)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",ao,[e.category.includes("#")?((0,s.uX)(),(0,s.CE)("div",lo,[(0,s.Lk)("span",null,(0,d.v_)(e.point)+" - "+(0,d.v_)(e.category.split("#")[0])+" "+(0,d.v_)(isNaN(e.category.split("#")[1])?e.category.split("#")[1]:e.category.split("#")[1]+(e.category.split("#")[1]%10==1&&e.category.split("#")[1]%100!=11?"st":e.category.split("#")[1]%10==2&&e.category.split("#")[1]%100!=12?"nd":e.category.split("#")[1]%10==3&&e.category.split("#")[1]%100!=13?"rd":"th")),1)])):((0,s.uX)(),(0,s.CE)("div",ro,[(0,s.Lk)("span",null,(0,d.v_)(e.point)+" - "+(0,d.v_)(isNaN(e.category)?e.category:e.category+(e.category%10==1&&e.category%100!=11?"st":e.category%10==2&&e.category%100!=12?"nd":e.category%10==3&&e.category%100!=13?"rd":"th")),1)]))]))])))),128))])],8,to)])):(0,s.Q3)("",!0)])))),128))])))),128))])])]))}};const no=so;var oo=no;const io=(0,s.Lk)("h1",null,"Race Maintenance",-1),uo=(0,s.Lk)("label",{for:"raceurl"},"URL:",-1),co=["disabled"],po=["disabled"],go=(0,s.Lk)("br",null,null,-1),vo=["value"],ko=["disabled"],ho=(0,s.Lk)("th",null,"Race Name",-1),mo=(0,s.Lk)("th",null,"Race URL",-1),yo=(0,s.Lk)("th",null,"Race Start Date",-1),Lo=(0,s.Lk)("th",null,"Racers",-1),fo=(0,s.Lk)("th",null,"Racer Specialties",-1),_o=(0,s.Lk)("th",null,"Youth Racers",-1),bo=(0,s.Lk)("th",null,"Stages",-1);var wo={__name:"RaceMaintenanceView",setup(e){const t=(0,c.KR)([]),a=(0,c.KR)({}),r=(0,c.KR)(""),n=async()=>{const e=localStorage.getItem("token"),a=await p.A.get("https://www.tourdefantasy.com/race",{headers:{Authorization:`Bearer ${e}`}});t.value=a.data.slice().sort(((e,t)=>Date.parse(t.start_date)-Date.parse(e.start_date)))},o=async()=>{const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/pcs?url=${r.value}`,{headers:{Authorization:`Bearer ${e}`}});let l=document.createElement("html");l.innerHTML=t.data;let s={days:[]};s.name=l.querySelector("div.main").textContent,s.url=r.value,l.querySelectorAll("div").forEach((e=>{"Startdate:"===e.textContent&&(s.start_date=e.nextSibling.nextSibling.textContent)}));let n={};l.querySelectorAll("h3").forEach((e=>{"Stages"===e.textContent&&(n=e.nextSibling.nextSibling)})),n.querySelector("table.basic").querySelectorAll("tbody tr").forEach(((e,t)=>{if("sum"===e.className)return;let a={};a.name=e.children[3].textContent,a.seq=t,a.url=e.children[3].firstChild.href,a.url&&(a.url=a.url.replace(document.location.origin,"https://www.procyclingstats.com")),s.days.push(a)})),l.innerHTML="<html></html>",a.value=s,r.value=""},i=()=>{console.log("selected")},u=()=>{p.A.put("https://www.tourdefantasy.com/race/raceinfo",a.value).then((function(e){alert(e.status)})),n()},g=async()=>{const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/pcs?url=${a.value.url}/startlist/top-competitors`,{headers:{Authorization:`Bearer ${e}`}});let l=document.createElement("html");l.innerHTML=t.data;let r=[];l.querySelector("table.basic").querySelectorAll("tbody tr").forEach((e=>{let t={};t.name=e.children[1].children[1].text,t.ranking=e.children[0].innerText,t.url=e.children[1].children[1].href,t.url&&(t.url=t.url.replace(document.location.origin,"https://www.procyclingstats.com")),t.nationality=e.children[1].children[0].className.split(" ")[1],t.race=a.value.url,r.push(t)})),l.innerHTML="<html></html>",p.A.put("https://www.tourdefantasy.com/racer/racerlist",r).then((function(e){console.log(e)}));const s=await p.A.get(`https://www.tourdefantasy.com/pcs?url=${a.value.url}/startlist/best-per-specialty`,{headers:{Authorization:`Bearer ${e}`}});l=document.createElement("html"),l.innerHTML=s.data,r=[],l.querySelectorAll("table.basic").forEach((e=>{let t=e.parentElement.previousSibling.previousSibling.textContent,l=a.value.url;e.querySelectorAll("tbody tr").forEach((e=>{let a={};a.racer=e.children[1].children[1].href,a.racer&&(a.racer=a.racer.replace(document.location.origin,"https://www.procyclingstats.com")),a.race=l,a.specialty=t,r.push(a)}))})),p.A.put("https://www.tourdefantasy.com/racer/racerspecialties",r).then((function(e){console.log(e)}));const n=await p.A.get(`https://www.tourdefantasy.com/pcs?url=${a.value.url}/startlist/youngest-oldest`,{headers:{Authorization:`Bearer ${e}`}});l=document.createElement("html"),l.innerHTML=n.data,r=[],l.querySelector("table.basic").querySelectorAll("tbody tr").forEach((e=>{let t={};t.racer=e.children[1].children[1].href,t.racer&&(t.racer=t.racer.replace(document.location.origin,"https://www.procyclingstats.com")),t.race=a.value.url,t.specialty="Youth",r.push(t)})),p.A.put("https://www.tourdefantasy.com/racer/racerspecialties",r).then((function(e){console.log(e)}));const o=await p.A.get(`https://www.tourdefantasy.com/pcs?url=${a.value.url}/startlist`,{headers:{Authorization:`Bearer ${e}`}});l=document.createElement("html"),l.innerHTML=o.data;const i=[];l.querySelectorAll("div .ridersCont").forEach((e=>{const t=e.querySelector("div .team").href.replace(document.location.origin,"https://www.procyclingstats.com"),l=e.querySelector("div .team").innerHTML,r=e.previousSibling.querySelector("img").src.replace(document.location.origin,"https://www.procyclingstats.com");console.log(t+" "+r),e.querySelectorAll("li").forEach((e=>{let s={};s.race=a.value.url,s.bib=e.querySelector(".bib").innerHTML,s.racer=e.querySelector("a").href.replace(document.location.origin,"https://www.procyclingstats.com"),s.team=t,s.teamname=l,s.teamimg=r,i.push(s)}))})),console.log(i),p.A.put("https://www.tourdefantasy.com/racer/racerteamandbib",i).then((function(e){console.log(e)})),alert("updated")};return(0,s.sV)((()=>{n()})),(e,n)=>((0,s.uX)(),(0,s.CE)("div",null,[io,uo,(0,s.bo)((0,s.Lk)("input",{type:"text",size:"70",id:"raceurl","onUpdate:modelValue":n[0]||(n[0]=e=>r.value=e)},null,512),[[l.Jo,r.value]]),(0,s.Lk)("button",{type:"button",onClick:o,disabled:!r.value}," Read Race",8,co),(0,s.Lk)("button",{type:"button",onClick:u,disabled:t.value.includes(a.value)}," Save Race",8,po),(0,s.eW)(),go,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":n[1]||(n[1]=e=>a.value=e),onChange:i},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.value,(e=>((0,s.uX)(),(0,s.CE)("option",{value:e,key:e},(0,d.v_)(e.name),9,vo)))),128))],544),[[l.u1,a.value]]),(0,s.Lk)("button",{type:"button",onClick:g,disabled:!a.value||!t.value.includes(a.value)}," Update Race Details ",8,ko),(0,s.Lk)("table",null,[(0,s.Lk)("tr",null,[ho,(0,s.Lk)("td",null,(0,d.v_)(a.value.name),1)]),(0,s.Lk)("tr",null,[mo,(0,s.Lk)("td",null,(0,d.v_)(a.value.url),1)]),(0,s.Lk)("tr",null,[yo,(0,s.Lk)("td",null,(0,d.v_)(a.value.start_date),1)]),(0,s.Lk)("tr",null,[Lo,(0,s.Lk)("td",null,(0,d.v_)(a.value.url)+"/startlist/top-competitors",1)]),(0,s.Lk)("tr",null,[fo,(0,s.Lk)("td",null,(0,d.v_)(a.value.url)+"/startlist/best-per-specialty",1)]),(0,s.Lk)("tr",null,[_o,(0,s.Lk)("td",null,(0,d.v_)(a.value.url)+"/startlist/youngest-oldest",1)]),(0,s.Lk)("tr",null,[bo,(0,s.Lk)("td",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value.days,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},[(0,s.Lk)("b",null,(0,d.v_)(e.name),1),(0,s.eW)(" "+(0,d.v_)(e.url),1)])))),128))])])])]))}};const Co=wo;var Eo=Co;const Ro=(0,s.Lk)("h1",null,"Automation Center",-1),Ao=["value"],xo=["id","value"],Xo=["for"];var So={__name:"AutomationCenterView",setup(e){const t=N(),a=(0,c.KR)([]),r=(0,c.KR)({}),n=(0,c.KR)({}),o=async()=>{const e=localStorage.getItem("token"),t=await p.A.get("https://www.tourdefantasy.com/league",{headers:{Authorization:`Bearer ${e}`}});a.value=t.data},i=async()=>{const e=localStorage.getItem("token"),t=await p.A.get(`https://www.tourdefantasy.com/race/url?url=${r.value.active_race_url}`,{headers:{Authorization:`Bearer ${e}`}});let a=t.data;a.days.sort(((e,t)=>e.seq-t.seq)),n.value=a},u=(0,s.EW)((()=>{if(!n.value.days)return[];let e=[{leagueId:r.value.id,name:"Draft",time:new Date(Date.parse(n.value.start_date)-288e5),path:"/rundraft"}];return n.value.days.forEach(((t,a)=>{t.url&&e.push({leagueId:r.value.id,name:"Score",time:new Date(Date.parse(n.value.start_date)+36e5*(24*a+12)),path:"/runscore",data:{stageURL:t.url}}),e.push({leagueId:r.value.id,name:"Trade",time:new Date(Date.parse(n.value.start_date)+36e5*(24*a+20)),path:"/runtrade"})})),e}));return(0,s.sV)((()=>{o()})),(e,o)=>((0,s.uX)(),(0,s.CE)("div",null,[Ro,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>r.value=e),onChange:i},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value,(e=>((0,s.uX)(),(0,s.CE)("option",{value:e,key:e},(0,d.v_)(e.name),9,Ao)))),128))],544),[[l.u1,r.value]]),(0,s.Lk)("button",{type:"button",onClick:o[1]||(o[1]=(...e)=>(0,c.R1)(t).flip&&(0,c.R1)(t).flip(...e))},(0,d.v_)((0,c.R1)(t).isAutoMode?"Stop":"Start"),1),(0,s.Lk)("div",null,[(0,s.Lk)("h2",null,(0,d.v_)(n.value.name),1),(0,s.Lk)("div",null,"Start Date: "+(0,d.v_)(n.value.start_date),1),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e},[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",id:e,value:e,"onUpdate:modelValue":o[2]||(o[2]=e=>(0,c.R1)(t).tasks=e)},null,8,xo),[[l.lH,(0,c.R1)(t).tasks]]),(0,s.Lk)("label",{for:e},[(0,s.Lk)("b",null,(0,d.v_)(e.name),1),(0,s.eW)(" - "+(0,d.v_)(e.time.toLocaleDateString())+" "+(0,d.v_)(e.time.toLocaleTimeString()),1)],8,Xo)])))),128))])])]))}};const Io=So;var To=Io;const Fo=(0,s.Lk)("h1",{class:"mt-4"},"Create League",-1),Ko={class:"row gx-5 mb-3"},Po={class:"col"},$o=(0,s.Lk)("label",{for:"exampleInputPassword1",class:"form-label"},"League Name",-1),Bo={class:"container px-4 text-center"},Do={class:"row gx-t"},Mo=(0,s.Lk)("label",{for:"raceselect",class:"form-label"},"Race",-1),qo=["value"],jo={class:"row gx-5 mb-3"},Wo={class:"col"},No=(0,s.Lk)("label",{for:"inputPassword",class:"form-label"},"League Password",-1),zo={class:"row gx-5 mb-3"},Vo={class:"col"},Oo=(0,s.Lk)("label",{for:"playernickname",class:"form-label"},"Your Nickname",-1),Ho={class:"row gx-5"},Qo={class:"col"};var Uo={__name:"CreateLeagueView",setup(e){const t=(0,W.rd)(),a=k(),r=(0,c.KR)(""),n=(0,c.KR)(""),o=(0,c.KR)(""),i=(0,c.KR)([]),u=(0,c.KR)({}),g=async()=>{let e={name:n.value,password:r.value,active_race_url:u.value.url,activeRace:u.value.name,admin:"ltseng",players:[]};const l=localStorage.getItem("token"),s=await p.A.post("https://www.tourdefantasy.com/league/create-league",e,{headers:{Authorization:`Bearer ${l}`}});console.log(s),await a.join(r.value,o.value),t.push({name:"LeagueHome"})},v=async()=>{const e=localStorage.getItem("token"),t=await p.A.get("https://www.tourdefantasy.com/race",{headers:{Authorization:`Bearer ${e}`}});i.value=t.data.slice().sort(((e,t)=>Date.parse(t.start_date)-Date.parse(e.start_date))),u.value=i.value[0]};return(0,s.sV)((()=>{v()})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[Fo,(0,s.Lk)("form",null,[(0,s.Lk)("div",Ko,[(0,s.Lk)("div",Po,[$o,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),class:"form-control",id:"exampleInputPassword1"},null,512),[[l.Jo,n.value]])])]),(0,s.Lk)("div",Bo,[(0,s.Lk)("div",Do,[Mo,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>u.value=e),id:"raceselect"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,(e=>((0,s.uX)(),(0,s.CE)("option",{value:e,key:e},(0,d.v_)(e.name),9,qo)))),128))],512),[[l.u1,u.value]])]),(0,s.Lk)("div",jo,[(0,s.Lk)("div",Wo,[No,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e),class:"form-control",id:"inputPassword","aria-describedby":"emailHelp"},null,512),[[l.Jo,r.value]])])]),(0,s.Lk)("div",zo,[(0,s.Lk)("div",Vo,[Oo,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>o.value=e),class:"form-control",id:"playernickname","aria-describedby":"emailHelp"},null,512),[[l.Jo,o.value]])])]),(0,s.Lk)("div",Ho,[(0,s.Lk)("div",Qo,[(0,s.Lk)("button",{onClick:(0,l.D$)(g,["prevent"]),class:"btn btn-success"},"Create")])])])])]))}};const Jo=Uo;var Yo=Jo;const Go=(0,s.Lk)("h1",{class:"mt-4"}," Past announcements",-1),Zo={class:"container w-75"},ei=["innerHTML"];var ti={__name:"NewsfeedView",setup(e){const t=k(),a=(0,s.EW)((()=>t.announcements.slice().reverse()));return(0,s.sV)((()=>{t.getAllAnnouncements()})),(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[Go,(0,s.Lk)("div",Zo,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:"alert alert-success alert-dismissible fade show",role:"alert"},[(0,s.Lk)("span",{innerHTML:e.message},null,8,ei)])))),128))])],64))}};const ai=ti;var li=ai;const ri=e=>((0,s.Qi)("data-v-c4214eda"),e=e(),(0,s.jt)(),e),si=ri((()=>(0,s.Lk)("h2",{class:"mt-4"},"My Team",-1))),ni={key:0,class:"alert alert-success alert-dismissible fade show"},oi={class:"d-flex justify-content-center mt-3"},ii={class:"d-flex flex-wrap justify-content-center mx-2"},ui={class:"d-flex align-items-center"},ci={class:"d-flex flex-column align-items-center"},di=["src"],pi={class:"text-muted text-center",style:{"font-size":"13px"}},gi={class:"content-wrapper"},vi={class:"card-title"},ki=["href"],hi={key:0,class:"card-text"},mi={key:1,class:"card-text"},yi=ri((()=>(0,s.Lk)("h2",{class:"mt-4"},"Available Racers",-1))),Li=["id","value"],fi=["for"],_i={class:"d-flex justify-content-center mt-3"},bi=["disabled"],wi={class:"d-flex flex-wrap justify-content-center mt-3 mx-2"},Ci=["onClick"],Ei={class:"d-flex align-items-center"},Ri={class:"d-flex flex-column align-items-center"},Ai=["src"],xi={class:"text-muted text-center",style:{"font-size":"13px"}},Xi={class:"content-wrapper"},Si={class:"card-title px-2"},Ii=["href"],Ti={key:0,class:"card-text px-2"},Fi={key:1,class:"card-text px-2"};var Ki={__name:"LiveDraftView",setup(e){const t=k(),a=v(),r=(0,s.EW)((()=>a.allRacers.filter((e=>!e.player&&(0===o.value.length||o.value.every((t=>e.specialties.includes(t)))))))),n=["GC","TT","Sprinter","One day races","Hills","Climber","Youth"],o=(0,c.KR)([]),i=(0,s.EW)((()=>new Map(a.allRacers.slice().map((e=>[e.url,e]))))),u=(0,s.EW)((()=>a.allRacers.filter((e=>e.player==t.leaguePlayer.player_strava_id)))),g=(0,c.KR)(null),h=e=>{g.value=e},m=(0,c.KR)(0),y=async()=>{await p.A.post("https://www.tourdefantasy.com/livedraft/draftracer",{league_id:t.league.id,player_id:t.leaguePlayer.player_strava_id,racer_url:g.value.url,seq:m.value}).then((function(e){console.log(e)})),g.value=null},L=(0,c.KR)([]),f=(0,s.EW)((()=>-1!=L.value.indexOf(m.value))),_=new AbortController,b=async()=>{try{console.log("Sending request");const e=await fetch(`https://www.tourdefantasy.com/livedraft/stream/${t.league.id}`,{method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("token"),Accept:"text/event-stream","Content-Type":"application/json"},signal:_.signal});if(e.body){const a=e.body.getReader(),l=new TextDecoder("utf-8");for(;;){const{done:e,value:r}=await a.read();if(e)break;const s=l.decode(r,{stream:!0});console.log(s);const n=t.parseChunk(s);n.forEach((e=>{console.log(e.eventType);const t=JSON.parse(e.data);"draft_position"===e.eventType?L.value=t:(m.value=t.slice(-1)[0].seq+1,t.slice().forEach((e=>{i.value.get(e.racer_url).player=e.player_id})),g.value&&i.value.get(g.value.url).player&&(g.value=null))}))}}console.log("Request sent")}catch(e){console.log(e)}};return(0,s.sV)((()=>{a.getRacerlist(t.league.active_race_url),b()})),(0,s.hi)((()=>{_.abort()})),(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[si,f.value?((0,s.uX)(),(0,s.CE)("div",ni," Your Turn")):(0,s.Q3)("",!0),(0,s.Lk)("div",oi,[(0,s.Lk)("div",ii,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:"card mb-3 mx-2 p-2",style:{width:"18rem"}},[(0,s.Lk)("div",ui,[(0,s.Lk)("div",ci,[(0,s.Lk)("img",{src:e.teamimg?e.teamimg:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image",style:{width:"50px",height:"50px"}},null,8,di),(0,s.Lk)("p",pi,"#"+(0,d.v_)(e.bib),1)]),(0,s.Lk)("div",gi,[(0,s.Lk)("h5",vi,[(0,s.Lk)("a",{href:e.url,target:"prosite"},(0,d.v_)(e.name),9,ki)]),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",hi,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",mi,"None"))])])])))),128))])]),yi,((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(n,(e=>(0,s.Lk)("span",{key:e,class:"px-2"},[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",id:e,value:e,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e)},null,8,Li),[[l.lH,o.value]]),(0,s.Lk)("label",{for:e}," "+(0,d.v_)(e),9,fi)]))),64)),(0,s.Lk)("div",_i,[(0,s.Lk)("button",{type:"button",class:"btn btn-success",onClick:t[1]||(t[1]=e=>y()),disabled:!g.value||!f.value},"Submit "+(0,d.v_)(m.value+1),9,bi)]),(0,s.Lk)("div",wi,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e,onClick:t=>h(e),class:(0,d.C4)(["card mb-3 mx-2 p-2",{"border-success-thick":g.value===e}]),style:{width:"18rem",cursor:"pointer"}},[(0,s.Lk)("div",Ei,[(0,s.Lk)("div",Ri,[(0,s.Lk)("img",{src:e.teamimg?e.teamimg:"blank-profile-picture.png",class:"img-fluid",alt:"Racer Image",style:{width:"50px",height:"50px"}},null,8,Ai),(0,s.Lk)("p",xi,"#"+(0,d.v_)(e.bib),1)]),(0,s.Lk)("div",Xi,[(0,s.Lk)("h5",Si,[(0,s.Lk)("a",{href:e.url,target:"prosite"},(0,d.v_)(e.name),9,Ii)]),e.specialties.length>0?((0,s.uX)(),(0,s.CE)("p",Ti,(0,d.v_)(e.specialties.join(", ")),1)):((0,s.uX)(),(0,s.CE)("p",Fi,"None"))])])],10,Ci)))),128))])],64))}};const Pi=(0,Y.A)(Ki,[["__scopeId","data-v-c4214eda"]]);var $i=Pi,Bi=a(2445);const Di=e=>((0,s.Qi)("data-v-52c073fd"),e=e(),(0,s.jt)(),e),Mi=Di((()=>(0,s.Lk)("h2",null,"Teams",-1))),qi=["disabled"],ji=["disabled"],Wi=["id","value"],Ni=["for"],zi=Di((()=>(0,s.Lk)("h2",null,"Available Racers",-1)));var Vi={__name:"RunLiveDraftView",setup(e){const t=k(),a=v(),r=(0,s.EW)((()=>a.allRacers.filter((e=>!e.player)))),n=(0,s.EW)((()=>new Map(a.allRacers.slice().map((e=>[e.url,e]))))),o=(0,s.EW)((()=>Map.groupBy(a.allRacers.slice(),(({player:e})=>e)))),i=(0,c.KR)(0),u=(0,s.EW)((()=>{const e=i.value,a=t.league.players.length;return e==12*a?-1:Math.floor(e/a)%2==0?e%a:a-e%a-1})),g=(0,c.KR)(!1),h=async()=>{if(console.log(a.allRacers.length+" "+r.value.length),a.allRacers.length==r.value.length){t.shuffle(),t.players.forEach((e=>{e.active_racers=[],e.bench_racers=[]}));const e=localStorage.getItem("token");await p.A.put("https://www.tourdefantasy.com/league/draftresult",t.players,{headers:{Authorization:`Bearer ${e}`}}),t.league.players=t.players.map((({player_strava_id:e})=>e))}g.value=!0},m=(0,c.KR)([]),y=async()=>{console.log(m.value),console.log(t.league.players[u.value]),m.value.includes(t.league.players[u.value])&&await p.A.post("https://www.tourdefantasy.com/livedraft/draftracer",{league_id:t.league.id,player_id:t.league.players[u.value],racer_url:r.value[0].url,seq:i.value}).then((function(e){console.log(e)}))},L=async()=>{t.players.forEach((e=>{const t=o.value.get(e.player_strava_id);e.active_racers=t.slice(0,8),e.bench_racers=t.slice(8)})),t.submitDraft(),t.league.players=t.players.map((({player_strava_id:e})=>e)),f.abort()},f=new AbortController,_=()=>{const e=localStorage.getItem("token");p.A.get(`https://www.tourdefantasy.com/livedraft/stream/${t.league.id}`,{headers:{Accept:"text/event-stream",Authorization:`Bearer ${e}`},responseType:"stream",adapter:"fetch",signal:f.signal}).then((async e=>{console.log("axios got a response");const t=e.data,a=t.pipeThrough(new Bi.A).getReader();for(;;){const{value:e,done:t}=await a.read();if(t)break;const l=JSON.parse(e.data);"draft_position"===e.type||(i.value=l.slice(-1)[0].seq+1,l.slice().forEach((e=>{n.value.get(e.racer_url).player=e.player_id})),l.length>0&&(g.value=!0),y())}})).catch((function(e){console.log(e)}))};return(0,s.sV)((()=>{a.getRacerlist(t.league.active_race_url),_()})),(0,s.hi)((()=>{f.abort()})),(e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[Mi,(0,s.Lk)("button",{onClick:a[0]||(a[0]=e=>h()),disabled:g.value}," Initialize Live Draft ",8,qi),(0,s.Lk)("button",{onClick:a[1]||(a[1]=e=>L()),disabled:-1!=u.value}," Submit Draft Results",8,ji),(0,s.Lk)("table",null,[(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,c.R1)(t).players,((e,t)=>((0,s.uX)(),(0,s.CE)("td",{key:e,class:(0,d.C4)({"border-success-thick":t===u.value})},[(0,s.Lk)("div",null,(0,d.v_)(e.player_nickname),1),(0,s.bo)((0,s.Lk)("input",{type:"checkbox",id:e.id,value:e.player_strava_id,"onUpdate:modelValue":a[2]||(a[2]=e=>m.value=e),onChange:a[3]||(a[3]=e=>y())},null,40,Wi),[[l.lH,m.value]]),(0,s.Lk)("label",{for:e.id},"auto",8,Ni),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.value.get(e.player_strava_id),(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},(0,d.v_)(e.name),1)))),128))],2)))),128))])])]),zi,(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e},(0,d.v_)(e.name),1)))),128))])],64))}};const Oi=(0,Y.A)(Vi,[["__scopeId","data-v-52c073fd"]]);var Hi=Oi;const Qi=[{path:"/runlivedraft",name:"RunLiveDraftView",component:Hi},{path:"/livedraft",name:"LiveDraftView",component:$i},{path:"/newsfeed",name:"NewsfeedView",component:li},{path:"/createleague",name:"CreateLeagueView",component:Yo},{path:"/autocenter",name:"AutomationCenterView",component:To},{path:"/racecenter",name:"RaceMaintenanceView",component:Eo},{path:"/leaguepreview",name:"LeaguePreview",component:ul,meta:{public:!0}},{path:"/fullscores",name:"FullScoreView",component:oo},{path:"/rosterview",name:"RosterView",component:Wn},{path:"/detailscore",name:"DetailScore",component:_n},{path:"/bypass",name:"ByPass",component:tn,meta:{public:!0}},{path:"/runscore",name:"RunScore",component:Vs},{path:"/runtrade",name:"RunTrade",component:Es},{path:"/trade",name:"Trade",component:vs},{path:"/rundraft",name:"RunDraft",component:vr},{path:"/roster",name:"Roster",component:ar},{path:"/draftlist",name:"DraftList",component:xl},{path:"/joinleague",name:"JoinLeague",component:Lt},{path:"/leaguehome",name:"LeagueHome",component:zt},{path:"/profile",name:"Profile",component:nt},{path:"/about",name:"about",component:()=>a.e(594).then(a.bind(a,5491)),meta:{public:!0}},{path:"/",name:"Login",component:de,meta:{public:!0}},{path:"/callback",name:"Callback",component:me,meta:{public:!0}},{path:"/activities",name:"Activities",component:be},{path:"/routes",name:"Routes",component:xe},{path:"/stats",name:"Stats",component:qe},{path:"/logout",name:"logout",component:Oe,meta:{public:!0}}],Ui=(0,W.aE)({history:(0,W.LA)("/"),routes:Qi});Ui.beforeEach(((e,t,a)=>{const l=g();console.log("to: "+e.path),console.log("private? "+!e.meta.public+" auth? "+!l.isAuthenticated),e.meta.public||l.isAuthenticated?a():a("/")}));var Ji=Ui;const Yi=(0,r.Ey)();(0,l.Ef)(Z).use(Yi).use(Ji).mount("#app")}},t={};function a(l){var r=t[l];if(void 0!==r)return r.exports;var s=t[l]={exports:{}};return e[l].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(t,l,r,s){if(!l){var n=1/0;for(c=0;c<e.length;c++){l=e[c][0],r=e[c][1],s=e[c][2];for(var o=!0,i=0;i<l.length;i++)(!1&s||n>=s)&&Object.keys(a.O).every((function(e){return a.O[e](l[i])}))?l.splice(i--,1):(o=!1,s<n&&(n=s));if(o){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[l,r,s]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,l){return a.f[l](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/about.d96a5a97.js"}}(),function(){a.miniCssF=function(e){return"css/about.3ec1852a.css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="TourDeFantasy:";a.l=function(l,r,s,n){if(e[l])e[l].push(r);else{var o,i;if(void 0!==s)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==l||d.getAttribute("data-webpack")==t+s){o=d;break}}o||(i=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",t+s),o.src=l),e[l]=[r];var p=function(t,a){o.onerror=o.onload=null,clearTimeout(g);var r=e[l];if(delete e[l],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((function(e){return e(a)})),t)return t(a)},g=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),i&&document.head.appendChild(o)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,l,r,s){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",a.nc&&(n.nonce=a.nc);var o=function(a){if(n.onerror=n.onload=null,"load"===a.type)r();else{var l=a&&a.type,o=a&&a.target&&a.target.href||t,i=new Error("Loading CSS chunk "+e+" failed.\n("+l+": "+o+")");i.name="ChunkLoadError",i.code="CSS_CHUNK_LOAD_FAILED",i.type=l,i.request=o,n.parentNode&&n.parentNode.removeChild(n),s(i)}};return n.onerror=n.onload=o,n.href=t,l?l.parentNode.insertBefore(n,l.nextSibling):document.head.appendChild(n),n},t=function(e,t){for(var a=document.getElementsByTagName("link"),l=0;l<a.length;l++){var r=a[l],s=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(s===e||s===t))return r}var n=document.getElementsByTagName("style");for(l=0;l<n.length;l++){r=n[l],s=r.getAttribute("data-href");if(s===e||s===t)return r}},l=function(l){return new Promise((function(r,s){var n=a.miniCssF(l),o=a.p+n;if(t(n,o))return r();e(l,o,null,r,s)}))},r={524:0};a.f.miniCss=function(e,t){var a={594:1};r[e]?t.push(r[e]):0!==r[e]&&a[e]&&t.push(r[e]=l(e).then((function(){r[e]=0}),(function(t){throw delete r[e],t})))}}}(),function(){var e={524:0};a.f.j=function(t,l){var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)l.push(r[2]);else{var s=new Promise((function(a,l){r=e[t]=[a,l]}));l.push(r[2]=s);var n=a.p+a.u(t),o=new Error,i=function(l){if(a.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var s=l&&("load"===l.type?"missing":l.type),n=l&&l.target&&l.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+n+")",o.name="ChunkLoadError",o.type=s,o.request=n,r[1](o)}};a.l(n,i,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,l){var r,s,n=l[0],o=l[1],i=l[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(r in o)a.o(o,r)&&(a.m[r]=o[r]);if(i)var c=i(a)}for(t&&t(l);u<n.length;u++)s=n[u],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(c)},l=self["webpackChunkTourDeFantasy"]=self["webpackChunkTourDeFantasy"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[504],(function(){return a(4155)}));l=a.O(l)})();
//# sourceMappingURL=app.09128e28.js.map